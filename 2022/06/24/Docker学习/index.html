<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"xiaowodi.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="[TOC] Docker 入门学习docker（容器化技术）  docker和虚拟机技术的不同 传统虚拟机，虚拟出一台硬件环境，运行一个完整的操作系统，然后在这个系统上安装和运行软件 容器内的应用直接运行在  宿主机  的内核中的，容器是没有自己的内核的，也没有虚拟我们的硬件，所以就轻便 每个容器间是互相隔离，每个容器内都有一个属于自己的文件系统，互不影响、   举个例子：之前使用虚拟机，电脑装了">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker入门学习">
<meta property="og:url" content="https://xiaowodi.github.io/2022/06/24/Docker%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="[TOC] Docker 入门学习docker（容器化技术）  docker和虚拟机技术的不同 传统虚拟机，虚拟出一台硬件环境，运行一个完整的操作系统，然后在这个系统上安装和运行软件 容器内的应用直接运行在  宿主机  的内核中的，容器是没有自己的内核的，也没有虚拟我们的硬件，所以就轻便 每个容器间是互相隔离，每个容器内都有一个属于自己的文件系统，互不影响、   举个例子：之前使用虚拟机，电脑装了">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="c:/Users/LuYu/AppData/Roaming/Typora/typora-user-images/image-20210605153338347.png">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2016/04/576507-docker1.png">
<meta property="og:image" content="c:/Users/LuYu/AppData/Roaming/Typora/typora-user-images/image-20210605185400973.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200411132031597.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0ODkxMjk1,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img1.baidu.com/it/u=3114630737,3916130790&fm=26&fmt=auto&gp=0.jpg">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F10379248343%2F0.jpg&refer=http%3A%2F%2Finews.gtimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1626488404&t=24a45ef82f2f339faeffe9c9a29caea6">
<meta property="og:image" content="https://img-blog.csdnimg.cn/202007171706264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NlZV95b3VfWVU=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://s4.51cto.com/images/blog/201711/27/462718f3cd35608c20481b33b09db020.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.liuhaihua.cn%2Fwp-content%2Fuploads%2F2016%2F08%2FMFB3Yjf.jpg&refer=http%3A%2F%2Fwww.liuhaihua.cn&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1626488126&t=67aeecd77f39cae1d12bb367c661085f">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.dongcoder.com%2Fup%2Finfo%2F201912%2F20191201213114965392.png&refer=http%3A%2F%2Fimg.dongcoder.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1626488249&t=cd0fff660b8407d3f0dbf318766d3a1f">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fseo-1255598498.file.myqcloud.com%2Ffull%2F4455082961bc017cb7c87a3463bb326e021013ce.jpg&refer=http%3A%2F%2Fseo-1255598498.file.myqcloud.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1626488342&t=d082a7ddde61f3208268b222179c264f">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/13618762-f1643a51d313a889.png?imageMogr2/auto-orient/strip|imageView2/2/w/1083/format/webp">
<meta property="og:image" content="c:/Users/LuYu/AppData/Roaming/Typora/typora-user-images/image-20210619121627000.png">
<meta property="article:published_time" content="2022-06-24T08:12:10.618Z">
<meta property="article:modified_time" content="2022-06-24T08:12:10.618Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:/Users/LuYu/AppData/Roaming/Typora/typora-user-images/image-20210605153338347.png">

<link rel="canonical" href="https://xiaowodi.github.io/2022/06/24/Docker%E5%AD%A6%E4%B9%A0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Docker入门学习 | Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://xiaowodi.github.io/2022/06/24/Docker%E5%AD%A6%E4%B9%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Docker入门学习
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-06-24 08:12:10" itemprop="dateCreated datePublished" datetime="2022-06-24T08:12:10+00:00">2022-06-24</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>[TOC]</p>
<h1 id="Docker-入门学习"><a href="#Docker-入门学习" class="headerlink" title="Docker 入门学习"></a>Docker 入门学习</h1><p>docker（容器化技术）</p>
<p><img src="C:\Users\LuYu\AppData\Roaming\Typora\typora-user-images\image-20210605153338347.png" alt="image-20210605153338347"></p>
<h3 id="docker和虚拟机技术的不同"><a href="#docker和虚拟机技术的不同" class="headerlink" title="docker和虚拟机技术的不同"></a>docker和虚拟机技术的不同</h3><ul>
<li>传统虚拟机，虚拟出一台硬件环境，运行一个完整的操作系统，然后在这个系统上安装和运行软件</li>
<li>容器内的应用直接运行在  <code>宿主机</code>  的内核中的，容器是没有自己的内核的，也没有虚拟我们的硬件，所以就轻便</li>
<li>每个容器间是互相隔离，每个容器内都有一个属于自己的文件系统，互不影响、</li>
</ul>
<blockquote>
<p>举个例子：之前使用虚拟机，电脑装了3个hadoop节点的集群，电脑就开始卡了</p>
<p>​                    使用容器后，你可能会装到30个（有点夸张了啊！）</p>
</blockquote>
<blockquote>
<p>DevOps（开发、运维）</p>
</blockquote>
<p>应用更快速的交付和部署、</p>
<p><strong>更快速的交付和部署</strong></p>
<p>传统：一堆帮助文档，安装程序</p>
<p>Docker：一键运行打包镜像发布测试，一键运行</p>
<p><strong>更便捷的升级和扩缩容</strong></p>
<p>使用了Docker之后，我们部署应用就和搭积木一样！！！</p>
<p>项目打包为一个镜像，扩展 服务器A！服务器B</p>
<p><strong>更简单的系统运维</strong></p>
<p>在容器化之后，我们的开发，测试环境都是高度一致的。（不会再出现在我的电脑上可以使用，再别人的电脑上就不可以使用了）</p>
<p><strong>更高效的计算资源利用：</strong></p>
<p>Docker是内核级别的虚拟化，可以再一个物理机上运行很多的容器实例！服务器的性能可以被压榨到极致。</p>
<h2 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h2><h3 id="Docker-的基本组成"><a href="#Docker-的基本组成" class="headerlink" title="Docker 的基本组成"></a>Docker 的基本组成</h3><p><img src="https://www.runoob.com/wp-content/uploads/2016/04/576507-docker1.png" alt="img"></p>
<ul>
<li><strong>镜像</strong>：Docker镜像（image），就相当于一个root文件系统。比如官方镜像ubuntu16.04就包含了完整的一套ubuntu16.04最下系统的root文件系统</li>
<li>**容器(Container)**：镜像和容器的关系，就像是面向对象程序设计中的类和对象一样，镜像是静态的定义，容器是镜像运行时的实例。容器可以被创建、启动、停止、删除、暂定等等。</li>
<li><strong>仓库（Repository）</strong>：仓库可看成一个代码控制中心，用来保存镜像。</li>
</ul>
<table>
<thead>
<tr>
<th>概念</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Docker镜像（Image）</strong></td>
<td>Docker镜像是用于创建Docker容器的模板，比如Ubuntu系统。</td>
</tr>
<tr>
<td><strong>Docker容器（Container）</strong></td>
<td>容器是独立运行的一个或一组应用，是镜像运行时的实体</td>
</tr>
<tr>
<td><strong>Docker客户端（Client）</strong></td>
<td>Docker客服端通过命令或者其他工具Docker SDK 与 Docker的守护进程通信。</td>
</tr>
<tr>
<td><strong>Docker主机（Host）</strong></td>
<td>一个物理或者虚拟的机器用于执行Docker守护进程和容器</td>
</tr>
<tr>
<td><strong>Docker Registry</strong></td>
<td>Docker仓库用来保存镜像，可以理解为代码控制中的代码仓库、<br />Docker Hub（<a target="_blank" rel="noopener" href="https://hub.docker.com)提供了庞大的镜像集合供使用(但是在国内,我们需要**配置镜像加速**)/">https://hub.docker.com）提供了庞大的镜像集合供使用（但是在国内，我们需要**配置镜像加速**）</a><br />一个Docker Registry中可以包含多个仓库（Repository）；每个仓库可以包含多个标签（tag）；每个标签对应一个镜像。<br />通常，一个仓库会包含同一个软件不同版本的镜像，而标签就常用于对应软件的各个版本。我们可以通过**&lt;仓库名&gt;:&lt;标签&gt;**的格式来指定具体是这个软件哪个版本的镜像。如果不给出标签，将以latest作为默认标签</td>
</tr>
<tr>
<td><strong>Docker Machine</strong></td>
<td>Docker Machine是一个简化Docker安装的命令行工具，通过一个简单的命令即可在相应的平台上安装Docker。<br />比如VirtualBox。Digital Ocean、Microsoft Azure</td>
</tr>
</tbody></table>
<h3 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h3><p>参考官方文档<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a></p>
<p>在centos7下安装docker</p>
<h4 id="卸载旧版"><a href="#卸载旧版" class="headerlink" title="卸载旧版"></a>卸载旧版</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure>

<h4 id="安装yum-yum-utils基础工具"><a href="#安装yum-yum-utils基础工具" class="headerlink" title="安装yum yum-utils基础工具"></a>安装yum yum-utils基础工具</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y yum-utils</span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">   --add-repo \</span><br><span class="line">   https://download.docker.com/linux/centos/docker-ce.repo  -- 配置docker的yum源，由于是国外的地址，我们需要配合国内的镜像</span><br><span class="line">   </span><br><span class="line">sudo yum install -y yum-utils</span><br><span class="line">sudo yum-config-manager \</span><br><span class="line">   --add-repo \</span><br><span class="line">   http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">   </span><br></pre></td></tr></table></figure>

<h4 id="更新yum索引"><a href="#更新yum索引" class="headerlink" title="更新yum索引"></a>更新yum索引</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure>

<h4 id="安装Docker引擎"><a href="#安装Docker引擎" class="headerlink" title="安装Docker引擎"></a>安装Docker引擎</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install docker-ce docker-ce-cli containerd.io</span><br></pre></td></tr></table></figure>

<h4 id="启动Docker服务"><a href="#启动Docker服务" class="headerlink" title="启动Docker服务"></a>启动Docker服务</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br></pre></td></tr></table></figure>

<h4 id="设置开机自启"><a href="#设置开机自启" class="headerlink" title="设置开机自启"></a>设置开机自启</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl enable docker.service	</span><br></pre></td></tr></table></figure>

<h4 id="设置docker镜像源"><a href="#设置docker镜像源" class="headerlink" title="设置docker镜像源"></a>设置docker镜像源</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">vim /etc/docker/daemon.json</span></span><br><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [&quot;https://iqckan08.mirror.aliyuncs.com&quot;]</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">$ </span><span class="language-bash">sudo systemctl daemon-reload 重载</span></span><br><span class="line"><span class="meta">$</span><span class="language-bash">sudo systemctl restart docker 最后检查是否·成功</span></span><br></pre></td></tr></table></figure>





<p>docker安装成功之后，输入docker version 可以查看docker是否安装成功</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[hadoop@hadoop102 ~]$ sudo docker version</span><br><span class="line">Client: Docker Engine - Community</span><br><span class="line"> Version:           20.10.7</span><br><span class="line"> API version:       1.41</span><br><span class="line"> Go version:        go1.13.15</span><br><span class="line"> Git commit:        f0df350</span><br><span class="line"> Built:             Wed Jun  2 11:58:10 2021</span><br><span class="line"> OS/Arch:           linux/amd64</span><br><span class="line"> Context:           default</span><br><span class="line"> Experimental:      true</span><br><span class="line"></span><br><span class="line">Server: Docker Engine - Community</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          20.10.7</span><br><span class="line">  API version:      1.41 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.13.15</span><br><span class="line">  Git commit:       b0f5bc3</span><br><span class="line">  Built:            Wed Jun  2 11:56:35 2021</span><br><span class="line">  OS/Arch:          linux/amd64</span><br><span class="line">  Experimental:     false</span><br><span class="line"> containerd:</span><br><span class="line">  Version:          1.4.6</span><br><span class="line">  GitCommit:        d71fcd7d8303cbf684402823e425e9dd2e99285d</span><br><span class="line"> runc:</span><br><span class="line">  Version:          1.0.0-rc95</span><br><span class="line">  GitCommit:        b9ee9c6314599f1b4a7f497e1f1f856fe433d3b7</span><br><span class="line"> docker-init:</span><br><span class="line">  Version:          0.19.0</span><br><span class="line">  GitCommit:        de40ad0</span><br></pre></td></tr></table></figure>

<h3 id="Docker底层原理"><a href="#Docker底层原理" class="headerlink" title="Docker底层原理"></a>Docker底层原理</h3><h4 id="Docker是怎么工作的？"><a href="#Docker是怎么工作的？" class="headerlink" title="Docker是怎么工作的？"></a>Docker是怎么工作的？</h4><p>Docker是一个Client-Server结构的系统，Docker的守护进程运行在主机上，通过Socket从客户端访问！</p>
<p>Docker-Server接收到Docker-Client的指令，就会执行这些指令<img src="C:\Users\LuYu\AppData\Roaming\Typora\typora-user-images\image-20210605185400973.png" alt="image-20210605185400973"></p>
<img src="https://img-blog.csdnimg.cn/20200411132031597.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0ODkxMjk1,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述" style="zoom:50%;" />







<h4 id="Docker为什么比VM快？"><a href="#Docker为什么比VM快？" class="headerlink" title="Docker为什么比VM快？"></a>Docker为什么比VM快？</h4><img src="https://img1.baidu.com/it/u=3114630737,3916130790&fm=26&fmt=auto&gp=0.jpg" alt="img" style="zoom:150%;" />

<ol>
<li>Docker有着比虚拟机更少的抽象层</li>
<li>Docker利用的是宿主机的内核（kernel，只有一个）<ol>
<li>而VM需要Guest OS。</li>
</ol>
</li>
</ol>
<p>所以说，新建一个容器的时候，，docker不需要像虚拟机一样重新加载一个操作系统内核，避免引导。虚拟机是加载Guest OS的，是分钟级别；而docker是利用宿主机的操作系统，省略了Guest OS那一层的加载，启动时秒级的。</p>
<p><strong>Host OS 与 Guest OS</strong></p>
<blockquote>
<p>Host OS(主人操作系统）就是安装在你硬件设备上的系统，而Guest OS(客人操作系统）则是安装在虚拟机（VM）上面的系统。</p>
</blockquote>
<blockquote>
<blockquote>
<p>例如你的电脑上的Windows系统就是作为Host OS,如果在你的电脑设备上拓展出一些虚拟机，并在虚拟机上安裝了 Windows XP，那么Windows XP 就叫做 Guest OS。</p>
</blockquote>
</blockquote>
<h2 id="Docker的常用命令"><a href="#Docker的常用命令" class="headerlink" title="Docker的常用命令"></a>Docker的常用命令</h2><h3 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker version			# 显示docker的版本信息</span><br><span class="line">docker info			    # 显示docker的系统信息，包括镜像和容器的数量</span><br><span class="line">docker 命令 --help	   # 帮助信息</span><br></pre></td></tr></table></figure>

<p>帮助文档的地址：<a target="_blank" rel="noopener" href="https://docs.docker.com/reference/">https://docs.docker.com/reference/</a></p>
<h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><h4 id="docker-images-查看所有本地的主机上的镜像"><a href="#docker-images-查看所有本地的主机上的镜像" class="headerlink" title="docker images 查看所有本地的主机上的镜像"></a><strong>docker images</strong> 查看所有本地的主机上的镜像</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">1. docker images</span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker images</span><br><span class="line">[sudo] hadoop 的密码：</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    d1165f221234   3 months ago   13.3kB</span><br><span class="line"><span class="meta">#</span><span class="language-bash">解释</span></span><br><span class="line">REPOSITORY		镜像的仓库名</span><br><span class="line">TAG				镜像的标签</span><br><span class="line">IMAGE ID		镜像的ID</span><br><span class="line">CREATED			镜像的创建时间</span><br><span class="line">SIZE			镜像的大小</span><br><span class="line"><span class="meta"># </span><span class="language-bash">可选项</span></span><br><span class="line">	-a，--all	#列出所有镜像</span><br><span class="line">	-q，--quiet  # 只显示镜像的ID</span><br><span class="line"><span class="meta"># </span><span class="language-bash">测试</span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker images -a</span><br><span class="line">[sudo] hadoop 的密码：</span><br><span class="line">REPOSITORY    TAG       IMAGE ID       CREATED        SIZE</span><br><span class="line">hello-world   latest    d1165f221234   3 months ago   13.3kB</span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker images -aq</span><br><span class="line">d1165f221234</span><br><span class="line">[hadoop@hadoop102 ~]$</span><br></pre></td></tr></table></figure>

<h4 id="docker-search搜索镜像"><a href="#docker-search搜索镜像" class="headerlink" title="docker search搜索镜像"></a><strong>docker search</strong>搜索镜像</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[hadoop@hadoop102 ~]$ sudo docker search mysql</span><br><span class="line">NAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED</span><br><span class="line">mysql                             MySQL is a widely used, open-source relation…   10957     [OK]</span><br><span class="line">mariadb                           MariaDB Server is a high performing open sou…   4142      [OK]</span><br><span class="line">mysql/mysql-server                Optimized MySQL Server Docker images. Create…   814                  [OK]</span><br><span class="line">percona                           Percona Server is a fork of the MySQL relati…   539       [OK]</span><br><span class="line">centos/mysql-57-centos7           MySQL 5.7 SQL database server                   88</span><br><span class="line">mysql/mysql-cluster               Experimental MySQL Cluster Docker images. Cr…   85</span><br><span class="line">centurylink/mysql                 Image containing mysql. Optimized to be link…   59                   [OK]</span><br><span class="line">bitnami/mysql                     Bitnami MySQL Docker Image                      52                   [OK]</span><br><span class="line">databack/mysql-backup             Back up mysql databases to... anywhere!         43</span><br><span class="line">deitch/mysql-backup               REPLACED! Please use http://hub.docker.com/r…   41                   [OK]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="docker-pull-tag-下载镜像"><a href="#docker-pull-tag-下载镜像" class="headerlink" title="docker pull[:tag] 下载镜像"></a><strong>docker pull[:tag]</strong> 下载镜像</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">[hadoop@hadoop102 ~]$ sudo docker pull --help</span><br><span class="line">[sudo] hadoop 的密码：</span><br><span class="line"></span><br><span class="line">Usage:  docker pull [OPTIONS] NAME[:TAG|@DIGEST]</span><br><span class="line"></span><br><span class="line">Pull an image or a repository from a registry</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -a, --all-tags                Download all tagged images in the repository</span><br><span class="line">      --disable-content-trust   Skip image verification (default true)</span><br><span class="line">      --platform string         Set platform if server is multi-platform capable</span><br><span class="line">  -q, --quiet                   Suppress verbose output</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">pull Mysql 镜像</span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker pull mysql</span><br><span class="line">Using default tag: latest			# 不指定tag， 默认最新版本</span><br><span class="line">latest: Pulling from library/mysql</span><br><span class="line">69692152171a: Downloading			# 分层下载，docker image的核心  联合文件系统</span><br><span class="line">1651b0be3df3: Downloading</span><br><span class="line">951da7386bc8: Downloading</span><br><span class="line">0f86c95aa242: Waiting</span><br><span class="line">37ba2d8bd4fe: Waiting</span><br><span class="line">6d278bb05e94: Downloading</span><br><span class="line">497efbd93a3e: Waiting</span><br><span class="line">f7fddf10c2c2: Waiting</span><br><span class="line">16415d159dfb: Waiting</span><br><span class="line">0e530ffc6b73: Waiting</span><br><span class="line">b0a4a1a77178: Waiting</span><br><span class="line">cd90f92aa9ef: Waiting</span><br><span class="line">latest: Pulling from library/mysql</span><br><span class="line">69692152171a: Pull complete</span><br><span class="line">1651b0be3df3: Pull complete</span><br><span class="line">951da7386bc8: Pull complete</span><br><span class="line">0f86c95aa242: Pull complete</span><br><span class="line">37ba2d8bd4fe: Pull complete</span><br><span class="line">6d278bb05e94: Pull complete</span><br><span class="line">497efbd93a3e: Pull complete</span><br><span class="line">f7fddf10c2c2: Pull complete</span><br><span class="line">16415d159dfb: Pull complete</span><br><span class="line">0e530ffc6b73: Pull complete</span><br><span class="line">b0a4a1a77178: Pull complete</span><br><span class="line">cd90f92aa9ef: Pull complete</span><br><span class="line">Digest: sha256:d50098d7fcb25b1fcb24e2d3247cae3fc55815d64fec640dc395840f8fa80969	# 签名</span><br><span class="line">Status: Downloaded newer image for mysql:lates</span><br><span class="line">docker.io/library/mysql:latest	# 真实地址</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">说明</span></span><br><span class="line">docker pull mysql</span><br><span class="line">docker pull docker.io/library/mysql:latest </span><br><span class="line"><span class="meta"># </span><span class="language-bash">上述这两条命令是等价的</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="docker-rmi-imageID-删除镜像、"><a href="#docker-rmi-imageID-删除镜像、" class="headerlink" title="docker rmi imageID:删除镜像、"></a><strong>docker rmi imageID</strong>:删除镜像、</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[hadoop@hadoop102 ~]$ sudo docker rmi --help</span><br><span class="line"></span><br><span class="line">Usage:  docker rmi [OPTIONS] IMAGE [IMAGE...]</span><br><span class="line"></span><br><span class="line">Remove one or more images</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -f, --force      Force removal of the image</span><br><span class="line">      --no-prune   Do not delete untagged parents</span><br><span class="line"><span class="meta"># </span><span class="language-bash">删除一个镜像</span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker rmi -f d1165f221234</span><br><span class="line">Untagged: hello-world:latest</span><br><span class="line">Untagged: hello-world@sha256:5122f6204b6a3596e048758cabba3c46b1c937a46b5be6225b835d091b90e46c</span><br><span class="line">Deleted: sha256:d1165f2212346b2bab48cb01c1e39ee8ad1be46b87873d9ca7a4e434980a7726</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">批量删除</span></span><br><span class="line">sudo docker rmi -f 镜像ID1 镜像ID2 镜像ID3	# 删除多个镜像，中间使用空格分隔</span><br><span class="line">sudo docker rmi -f `sudo docker images -aq` #删除全部镜像</span><br><span class="line">sudo docker rmi -f $(sudo docker images -aq) #删除全部镜像</span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker rmi -f `sudo docker images -aq`  # 查找出所有的images的ID</span><br><span class="line">Untagged: mysql:5.7</span><br><span class="line">Untagged: mysql@sha256:a682e3c78fc5bd941e9db080b4796c75f69a28a8cad65677c23f7a9f18ba21fa</span><br><span class="line">Deleted: sha256:2c9028880e5814e8923c278d7e2059f9066d56608a21cd3f83a01e3337bacd68</span><br><span class="line">Deleted: sha256:c49c5c776f1bc87cdfff451ef39ce16a1ef45829e10203f4d9a153a6889ec15e</span><br><span class="line">Deleted: sha256:8345316eca77700e62470611446529113579712a787d356e5c8656a41c244aee</span><br><span class="line">Deleted: sha256:8ae51b87111404bd3e3bde4115ea2fe3fd2bb2cf67158460423c361a24df156b</span><br><span class="line">Deleted: sha256:9d5afda6f6dcf8dd59aef5c02099f1d3b3b0c9ae4f2bb7a61627613e8cdfe562</span><br><span class="line">Untagged: mysql:latest</span><br><span class="line">Untagged: mysql@sha256:d50098d7fcb25b1fcb24e2d3247cae3fc55815d64fec640dc395840f8fa80969</span><br><span class="line">Deleted: sha256:c0cdc95609f1fc1daf2c7cae05ebd6adcf7b5c614b4f424949554a24012e3c09</span><br><span class="line">Deleted: sha256:137bebc5ea278e61127e13cc7312fd83874cd19e392ee87252b532f0162fbd56</span><br><span class="line">Deleted: sha256:7ed0de2ad4e43c97f58fa9e81fba73700167ef9f8a9970685059e0109749a56b</span><br><span class="line">Deleted: sha256:9375660fbff871cd29c86b8643be60e376bfc96e99a3d7e8f93d74cd61500705</span><br><span class="line">Deleted: sha256:d8a47065d005ac34d81017677330ce096eb5562eeb971e2db12b0e200fdb1cb6</span><br><span class="line">Deleted: sha256:ca13c8ad9df5d824d5a259a927eaa6c04a60f022bc2abe8fc7866cf4b2b366f4</span><br><span class="line">Deleted: sha256:7af1865d5c19316c3dc0829a2ee2b3a744ae756f7fec9c213d3afc5f1f6ed306</span><br><span class="line">Deleted: sha256:f205c8f3c8aaa6376442b34c0c2062738461d37e0aa16ba021cd7e09c67213c2</span><br><span class="line">Deleted: sha256:d690e8a8242cf13cbe98c5b2faffdd0fc7e6c4c13425b5da31de991aa1f89a76</span><br><span class="line">Deleted: sha256:24efeee958e9f3d859fe15540e9296d5aaa6d3eb3b5f5494a2e8370608a4cfaa</span><br><span class="line">Deleted: sha256:654f2ffede3bb536fd62d04c9c7b7826e890828bec92182634e38684959b2498</span><br><span class="line">Deleted: sha256:de478a06eaa676052e665faa0b07d86a007f4b87cf82eb46a258742dc2d32260</span><br><span class="line">Deleted: sha256:02c055ef67f5904019f43a41ea5f099996d8e7633749b6e606c400526b2c4b33</span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker images</span><br><span class="line">REPOSITORY   TAG       IMAGE ID   CREATED   SIZE</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><h4 id="新建容器并启动：docker-run"><a href="#新建容器并启动：docker-run" class="headerlink" title="新建容器并启动：docker run"></a>新建容器并启动：docker run</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">[hadoop@hadoop102 ~]$ sudo docker run --help</span><br><span class="line"></span><br><span class="line">Usage:  docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br><span class="line"></span><br><span class="line">Run a command in a new container</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --add-host list                  Add a custom host-to-IP mapping (host:ip)</span><br><span class="line">  -a, --attach list                    Attach to STDIN, STDOUT or STDERR</span><br><span class="line">      --blkio-weight uint16            Block IO (relative weight), between 10 and 1000, or 0 to disable (default 0)</span><br><span class="line">      --blkio-weight-device list       Block IO weight (relative device weight) (default [])</span><br><span class="line">      --cap-add list                   Add Linux capabilities</span><br><span class="line">      --cap-drop list                  Drop Linux capabilities</span><br><span class="line">      --cgroup-parent string           Optional parent cgroup for the container</span><br><span class="line">      --cgroupns string                Cgroup namespace to use (host|private)</span><br><span class="line">                                       &#x27;host&#x27;:    Run the container in the Docker host&#x27;s cgroup namespace</span><br><span class="line">                                       &#x27;private&#x27;: Run the container in its own private cgroup namespace</span><br><span class="line">                                       &#x27;&#x27;:        Use the cgroup namespace as configured by the</span><br><span class="line">                                                  default-cgroupns-mode option on the daemon (default)</span><br><span class="line">      --cidfile string                 Write the container ID to the file</span><br><span class="line">      --cpu-period int                 Limit CPU CFS (Completely Fair Scheduler) period</span><br><span class="line">      --cpu-quota int                  Limit CPU CFS (Completely Fair Scheduler) quota</span><br><span class="line">      --cpu-rt-period int              Limit CPU real-time period in microseconds</span><br><span class="line">      --cpu-rt-runtime int             Limit CPU real-time runtime in microseconds</span><br><span class="line">  -c, --cpu-shares int                 CPU shares (relative weight)</span><br><span class="line">      --cpus decimal                   Number of CPUs</span><br><span class="line">      --cpuset-cpus string             CPUs in which to allow execution (0-3, 0,1)</span><br><span class="line">      --cpuset-mems string             MEMs in which to allow execution (0-3, 0,1)</span><br><span class="line">  -d, --detach                         Run container in background and print container ID</span><br><span class="line">      --detach-keys string             Override the key sequence for detaching a container</span><br><span class="line">      --device list                    Add a host device to the container</span><br><span class="line">      --device-cgroup-rule list        Add a rule to the cgroup allowed devices list</span><br><span class="line">      --device-read-bps list           Limit read rate (bytes per second) from a device (default [])</span><br><span class="line">      --device-read-iops list          Limit read rate (IO per second) from a device (default [])</span><br><span class="line">      --device-write-bps list          Limit write rate (bytes per second) to a device (default [])</span><br><span class="line">      --device-write-iops list         Limit write rate (IO per second) to a device (default [])</span><br><span class="line">      --disable-content-trust          Skip image verification (default true)</span><br><span class="line">      --dns list                       Set custom DNS servers</span><br><span class="line">      --dns-option list                Set DNS options</span><br><span class="line">      --dns-search list                Set custom DNS search domains</span><br><span class="line">      --domainname string              Container NIS domain name</span><br><span class="line">      --entrypoint string              Overwrite the default ENTRYPOINT of the image</span><br><span class="line">  -e, --env list                       Set environment variables</span><br><span class="line">      --env-file list                  Read in a file of environment variables</span><br><span class="line">      --expose list                    Expose a port or a range of ports</span><br><span class="line">      --gpus gpu-request               GPU devices to add to the container (&#x27;all&#x27; to pass all GPUs)</span><br><span class="line">      --group-add list                 Add additional groups to join</span><br><span class="line">      --health-cmd string              Command to run to check health</span><br><span class="line">      --health-interval duration       Time between running the check (ms|s|m|h) (default 0s)</span><br><span class="line">      --health-retries int             Consecutive failures needed to report unhealthy</span><br><span class="line">      --health-start-period duration   Start period for the container to initialize before starting health-retries countdown (ms|s|m|h) (default 0s)</span><br><span class="line">      --health-timeout duration        Maximum time to allow one check to run (ms|s|m|h) (default 0s)</span><br><span class="line">      --help                           Print usage</span><br><span class="line">  -h, --hostname string                Container host name</span><br><span class="line">      --init                           Run an init inside the container that forwards signals and reaps processes</span><br><span class="line">  -i, --interactive                    Keep STDIN open even if not attached</span><br><span class="line">      --ip string                      IPv4 address (e.g., 172.30.100.104)</span><br><span class="line">      --ip6 string                     IPv6 address (e.g., 2001:db8::33)</span><br><span class="line">      --ipc string                     IPC mode to use</span><br><span class="line">      --isolation string               Container isolation technology</span><br><span class="line">      --kernel-memory bytes            Kernel memory limit</span><br><span class="line">  -l, --label list                     Set meta data on a container</span><br><span class="line">      --label-file list                Read in a line delimited file of labels</span><br><span class="line">      --link list                      Add link to another container</span><br><span class="line">      --link-local-ip list             Container IPv4/IPv6 link-local addresses</span><br><span class="line">      --log-driver string              Logging driver for the container</span><br><span class="line">      --log-opt list                   Log driver options</span><br><span class="line">      --mac-address string             Container MAC address (e.g., 92:d0:c6:0a:29:33)</span><br><span class="line">  -m, --memory bytes                   Memory limit</span><br><span class="line">      --memory-reservation bytes       Memory soft limit</span><br><span class="line">      --memory-swap bytes              Swap limit equal to memory plus swap: &#x27;-1&#x27; to enable unlimited swap</span><br><span class="line">      --memory-swappiness int          Tune container memory swappiness (0 to 100) (default -1)</span><br><span class="line">      --mount mount                    Attach a filesystem mount to the container</span><br><span class="line">      --name string                    Assign a name to the container</span><br><span class="line">      --network network                Connect a container to a network</span><br><span class="line">      --network-alias list             Add network-scoped alias for the container</span><br><span class="line">      --no-healthcheck                 Disable any container-specified HEALTHCHECK</span><br><span class="line">      --oom-kill-disable               Disable OOM Killer</span><br><span class="line">      --oom-score-adj int              Tune host&#x27;s OOM preferences (-1000 to 1000)</span><br><span class="line">      --pid string                     PID namespace to use</span><br><span class="line">      --pids-limit int                 Tune container pids limit (set -1 for unlimited)</span><br><span class="line">      --platform string                Set platform if server is multi-platform capable</span><br><span class="line">      --privileged                     Give extended privileges to this container</span><br><span class="line">  -p, --publish list                   Publish a container&#x27;s port(s) to the host</span><br><span class="line">  -P, --publish-all                    Publish all exposed ports to random ports</span><br><span class="line">      --pull string                    Pull image before running (&quot;always&quot;|&quot;missing&quot;|&quot;never&quot;) (default &quot;missing&quot;)</span><br><span class="line">      --read-only                      Mount the container&#x27;s root filesystem as read only</span><br><span class="line">      --restart string                 Restart policy to apply when a container exits (default &quot;no&quot;)</span><br><span class="line">      --rm                             Automatically remove the container when it exits</span><br><span class="line">      --runtime string                 Runtime to use for this container</span><br><span class="line">      --security-opt list              Security Options</span><br><span class="line">      --shm-size bytes                 Size of /dev/shm</span><br><span class="line">      --sig-proxy                      Proxy received signals to the process (default true)</span><br><span class="line">      --stop-signal string             Signal to stop a container (default &quot;SIGTERM&quot;)</span><br><span class="line">      --stop-timeout int               Timeout (in seconds) to stop a container</span><br><span class="line">      --storage-opt list               Storage driver options for the container</span><br><span class="line">      --sysctl map                     Sysctl options (default map[])</span><br><span class="line">      --tmpfs list                     Mount a tmpfs directory</span><br><span class="line">  -t, --tty                            Allocate a pseudo-TTY</span><br><span class="line">      --ulimit ulimit                  Ulimit options (default [])</span><br><span class="line">  -u, --user string                    Username or UID (format: &lt;name|uid&gt;[:&lt;group|gid&gt;])</span><br><span class="line">      --userns string                  User namespace to use</span><br><span class="line">      --uts string                     UTS namespace to use</span><br><span class="line">  -v, --volume list                    Bind mount a volume</span><br><span class="line">      --volume-driver string           Optional volume driver for the container</span><br><span class="line">      --volumes-from list              Mount volumes from the specified container(s)</span><br><span class="line">  -w, --workdir string                 Working directory inside the container</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">docker run [可选参数] image   常用参数说明</span></span><br><span class="line">--name=&quot;Name&quot;			# 容器的名字，给容器起个名字，用来区分容器</span><br><span class="line">-d						# 后台方式运行，类似于nohup</span><br><span class="line">-it						# 使用交互式方式运行，进入容器查看内容</span><br><span class="line">-p						# 指定容器的端口， -p 8080:8080</span><br><span class="line">						-p ip:主机端口:容器端口</span><br><span class="line">						-p 主机端口:容器端口（常用）</span><br><span class="line">						-p 容器端口</span><br><span class="line">						容器端口</span><br><span class="line">-P						# 随机指定端口</span><br><span class="line"><span class="meta"># </span><span class="language-bash">测试使用，启动并进入容器  -i 交互式方式  -t 终端   /bin/bash 交互式方式</span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker run -it centos /bin/bash</span><br><span class="line">[root@713702cc6293 /]# ls</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="退出容器：exit"><a href="#退出容器：exit" class="headerlink" title="退出容器：exit"></a>退出容器：exit</h4><p>exit退出容器后，容器就停止了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctrl+p+q  退出后，容器不停止</span><br></pre></td></tr></table></figure>



<h4 id="查看运行的容器：docker-ps"><a href="#查看运行的容器：docker-ps" class="headerlink" title="查看运行的容器：docker ps"></a>查看运行的容器：docker ps</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">查看正在运行的容器有哪些</span></span><br><span class="line">docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">docker ps</span></span><br><span class="line"><span class="meta">		# </span><span class="language-bash">不带任何选项，列出正在运行的容器</span></span><br><span class="line">-a		# 列出正在运行的容器+历史运行过的容器</span><br><span class="line">-a -n=? # 显示最近使用的？个容器</span><br><span class="line">-q		# 只显示</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">查看曾经所有运行过的容器有哪些</span></span><br><span class="line">docker pa -a</span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND       CREATED          STATUS                      PORTS     NAMES</span><br><span class="line">713702cc6293   centos         &quot;/bin/bash&quot;   23 seconds ago   Exited (0) 8 seconds ago              goofy_fermat</span><br><span class="line">fa6d40911878   300e315adb2f   &quot;/bin/bash&quot;   34 minutes ago   Exited (0) 34 minutes ago             Centos_OS</span><br><span class="line">06b202339143   d1165f221234   &quot;/hello&quot;      5 hours ago      Exited (0) 5 hours ago                jolly_perlman</span><br><span class="line">4b43a5cdbedc   d1165f221234   &quot;/hello&quot;      5 hours ago      Exited (0) 5 hours ago                lucid_brahmagupta</span><br></pre></td></tr></table></figure>

<h4 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器id				# 删除指定的容器 不能删除正在运行的容器</span><br><span class="line">docker rm -f $(docker ps -aq)	# 删除所有的容器</span><br><span class="line">docker ps -aq | xargs docker rm  # 利用linux的管道进行删除所有的容器</span><br></pre></td></tr></table></figure>

<h4 id="启动和停止容器的操作"><a href="#启动和停止容器的操作" class="headerlink" title="启动和停止容器的操作"></a>启动和停止容器的操作</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器id</span><br><span class="line">docker restart 容器id</span><br><span class="line">docker stop 容器id</span><br><span class="line">docker kill 容器id  # 强制杀掉容器</span><br></pre></td></tr></table></figure>

<h3 id="常用其他命令"><a href="#常用其他命令" class="headerlink" title="常用其他命令"></a>常用其他命令</h3><h4 id="后台启动-容器"><a href="#后台启动-容器" class="headerlink" title="后台启动+容器"></a>后台启动+容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="language-bash">命令 docker run -d 镜像名</span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker run -d centos</span><br><span class="line">6aeb3d547f3ecfdc38c27148fe59033fb7cd74b49acd61c2b236bc422e0b3d85</span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br><span class="line">[hadoop@hadoop102 ~]$</span><br><span class="line"><span class="meta"># </span><span class="language-bash">问题：docker ps 发现 刚刚后台启动的容器停止了</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">常见的坑：docker 容器使用后台运行，就必须要有一个前台进程，docker发现没有应用，就会自动停止</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">nginx，容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了。</span></span><br></pre></td></tr></table></figure>

<h4 id="显示日志"><a href="#显示日志" class="headerlink" title="显示日志"></a>显示日志</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[hadoop@hadoop102 ~]$ sudo docker logs --help</span><br><span class="line"></span><br><span class="line">Usage:  docker logs [OPTIONS] CONTAINER</span><br><span class="line"></span><br><span class="line">Fetch the logs of a container</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --details        Show extra details provided to logs</span><br><span class="line">  -f, --follow         Follow log output</span><br><span class="line">      --since string   Show logs since timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)</span><br><span class="line">  -n, --tail string    Number of lines to show from the end of the logs (default &quot;all&quot;)</span><br><span class="line">  -t, --timestamps     Show timestamps</span><br><span class="line">      --until string   Show logs before a timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes)</span><br></pre></td></tr></table></figure>



<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">docker logs -tf --<span class="built_in">tail</span> 10 容器<span class="built_in">id</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">创建一个容器，并执行一段shell脚本命令</span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker run -d 300e315adb2f /bin/sh -c &quot;while true;do echo luyu;sleep 1;done&quot;</span><br><span class="line">aac0df3b1f54b0ed7b637423d1800d363ebeb20901f5cb17b2d33597c3b3fe0d</span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker ps -a</span><br><span class="line">CONTAINER ID   IMAGE          COMMAND                  CREATED          STATUS          PORTS     NAMES</span><br><span class="line">aac0df3b1f54   300e315adb2f   &quot;/bin/sh -c &#x27;while t…&quot;   12 seconds ago   Up 11 seconds             upbeat_blackburn</span><br><span class="line"><span class="meta"># </span><span class="language-bash">查看容器aac0df3b1f54的日志</span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker logs -ft --tail 10  aac0df3b1f54</span><br><span class="line">2021-06-08T14:46:13.046146963Z luyu</span><br><span class="line">2021-06-08T14:46:14.051677179Z luyu</span><br><span class="line">2021-06-08T14:46:15.054572203Z luyu</span><br><span class="line">2021-06-08T14:46:16.061439230Z luyu</span><br><span class="line">2021-06-08T14:46:17.065692351Z luyu</span><br><span class="line">2021-06-08T14:46:18.069007728Z luyu</span><br><span class="line">2021-06-08T14:46:19.073717192Z luyu</span><br><span class="line">2021-06-08T14:46:20.079255001Z luyu</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="查看容器中的进程信息（top）"><a href="#查看容器中的进程信息（top）" class="headerlink" title="查看容器中的进程信息（top）"></a>查看容器中的进程信息（top）</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">docker top 容器<span class="built_in">id</span></span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker top aac0df3b1f54</span><br><span class="line">UID                 PID(父id)           PPID(进程id)         C                   STIME </span><br><span class="line">root                5604                5584                0                   22:56</span><br><span class="line">root                5720                5604                0                   22:57</span><br></pre></td></tr></table></figure>

<h4 id="查看镜像的元数据-inspect"><a href="#查看镜像的元数据-inspect" class="headerlink" title="查看镜像的元数据(inspect)"></a>查看镜像的元数据(inspect)</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[hadoop@hadoop102 ~]$ sudo docker inspect --help</span><br><span class="line">[sudo] hadoop 的密码：</span><br><span class="line"></span><br><span class="line">Usage:  docker inspect [OPTIONS] NAME|ID [NAME|ID...]</span><br><span class="line"></span><br><span class="line">Return low-level information on Docker objects</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">  -f, --format string   Format the output using the given Go template</span><br><span class="line">  -s, --size            Display total file sizes if the type is container</span><br><span class="line">      --type string     Return JSON for specified type</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">使用docker inspect 容器<span class="built_in">id</span> 可以查看容器的元数据</span></span><br><span class="line">[hadoop@hadoop102 ~]$ sudo docker inspect aac0df3b1f54</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Id&quot;: &quot;aac0df3b1f54b0ed7b637423d1800d363ebeb20901f5cb17b2d33597c3b3fe0d&quot;, # id</span><br><span class="line">        &quot;Created&quot;: &quot;2021-06-08T14:41:33.14773429Z&quot;, # 创建时间</span><br><span class="line">        &quot;Path&quot;: &quot;/bin/sh&quot;,		# sh控制台</span><br><span class="line">        &quot;Args&quot;: [				# 传递的参数</span><br><span class="line">            &quot;-c&quot;,</span><br><span class="line">            &quot;while true;do echo luyu;sleep 1;done&quot;</span><br><span class="line">        ],</span><br><span class="line">        &quot;State&quot;: &#123;				# 该容器的状态</span><br><span class="line">            &quot;Status&quot;: &quot;exited&quot;,</span><br><span class="line">            &quot;Running&quot;: false,</span><br><span class="line">            &quot;Paused&quot;: false,</span><br><span class="line">            &quot;Restarting&quot;: false,</span><br><span class="line">            &quot;OOMKilled&quot;: false,</span><br><span class="line">            &quot;Dead&quot;: false,</span><br><span class="line">            &quot;Pid&quot;: 0,				# 父进程的id</span><br><span class="line">            &quot;ExitCode&quot;: 137,</span><br><span class="line">            &quot;Error&quot;: &quot;&quot;,</span><br><span class="line">            &quot;StartedAt&quot;: &quot;2021-06-08T14:56:40.814242482Z&quot;,</span><br><span class="line">            &quot;FinishedAt&quot;: &quot;2021-06-08T15:17:58.965385381Z&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        # 从哪个镜像创建的</span><br><span class="line">        &quot;Image&quot;: &quot;sha256:300e315adb2f96afe5f0b2780b87f28ae95231fe3bdd1e16b9ba606307728f55&quot;,</span><br><span class="line">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/aac0df3b1f54b0ed7b637423d1800d363ebeb20901f5cb17b2d33597c3b3fe0d/resolv.conf&quot;,  </span><br><span class="line">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/aac0df3b1f54b0ed7b637423d1800d363ebeb20901f5cb17b2d33597c3b3fe0d/hostname&quot;,</span><br><span class="line">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/aac0df3b1f54b0ed7b637423d1800d363ebeb20901f5cb17b2d33597c3b3fe0d/hosts&quot;,</span><br><span class="line">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/aac0df3b1f54b0ed7b637423d1800d363ebeb20901f5cb17b2d33597c3b3fe0d/aac0df3b1f54b0ed7b637423d1800d363ebeb2090</span><br><span class="line">1f5cb17b2d33597c3b3fe0d-json.log&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;/upbeat_blackburn&quot;,</span><br><span class="line">        &quot;RestartCount&quot;: 0,</span><br><span class="line">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br><span class="line">        &quot;Platform&quot;: &quot;linux&quot;,</span><br><span class="line">        &quot;MountLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br><span class="line">        &quot;AppArmorProfile&quot;: &quot;&quot;,</span><br><span class="line">        &quot;ExecIDs&quot;: null,</span><br><span class="line">        &quot;HostConfig&quot;: &#123;</span><br><span class="line">            &quot;Binds&quot;: null,</span><br><span class="line">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LogConfig&quot;: &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;json-file&quot;,</span><br><span class="line">                &quot;Config&quot;: &#123;&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;NetworkMode&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;PortBindings&quot;: &#123;&#125;,</span><br><span class="line">            &quot;RestartPolicy&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;no&quot;,</span><br><span class="line">                &quot;MaximumRetryCount&quot;: 0</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;AutoRemove&quot;: false,</span><br><span class="line">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br><span class="line">            &quot;VolumesFrom&quot;: null,</span><br><span class="line">            &quot;CapAdd&quot;: null,</span><br><span class="line">            &quot;CapDrop&quot;: null,</span><br><span class="line">            &quot;CgroupnsMode&quot;: &quot;host&quot;,</span><br><span class="line">            &quot;Dns&quot;: [],</span><br><span class="line">            &quot;DnsOptions&quot;: [],</span><br><span class="line">            &quot;DnsSearch&quot;: [],</span><br><span class="line">            &quot;ExtraHosts&quot;: null,</span><br><span class="line">            &quot;GroupAdd&quot;: null,</span><br><span class="line">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br><span class="line">            &quot;Cgroup&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Links&quot;: null,</span><br><span class="line">            &quot;OomScoreAdj&quot;: 0,</span><br><span class="line">            &quot;PidMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Privileged&quot;: false,</span><br><span class="line">            &quot;PublishAllPorts&quot;: false,</span><br><span class="line">            &quot;ReadonlyRootfs&quot;: false,</span><br><span class="line">            &quot;SecurityOpt&quot;: null,</span><br><span class="line">            &quot;UTSMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br><span class="line">            &quot;ShmSize&quot;: 67108864,</span><br><span class="line">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br><span class="line">            &quot;ConsoleSize&quot;: [</span><br><span class="line">                0,</span><br><span class="line">                0</span><br><span class="line">            ],</span><br><span class="line">            &quot;Isolation&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpuShares&quot;: 0,</span><br><span class="line">            &quot;Memory&quot;: 0,</span><br><span class="line">            &quot;NanoCpus&quot;: 0,</span><br><span class="line">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br><span class="line">            &quot;BlkioWeight&quot;: 0,</span><br><span class="line">            &quot;BlkioWeightDevice&quot;: [],</span><br><span class="line">            &quot;BlkioDeviceReadBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteBps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceReadIOps&quot;: null,</span><br><span class="line">            &quot;BlkioDeviceWriteIOps&quot;: null,</span><br><span class="line">            &quot;CpuPeriod&quot;: 0,</span><br><span class="line">            &quot;CpuQuota&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimePeriod&quot;: 0,</span><br><span class="line">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br><span class="line">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br><span class="line">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Devices&quot;: [],</span><br><span class="line">            &quot;DeviceCgroupRules&quot;: null,</span><br><span class="line">            &quot;DeviceRequests&quot;: null,</span><br><span class="line">            &quot;KernelMemory&quot;: 0,</span><br><span class="line">            &quot;KernelMemoryTCP&quot;: 0,</span><br><span class="line">            &quot;MemoryReservation&quot;: 0,</span><br><span class="line">            &quot;MemorySwap&quot;: 0,</span><br><span class="line">            &quot;MemorySwappiness&quot;: null,</span><br><span class="line">            &quot;OomKillDisable&quot;: false,</span><br><span class="line">            &quot;PidsLimit&quot;: null,</span><br><span class="line">            &quot;Ulimits&quot;: null,</span><br><span class="line">            &quot;CpuCount&quot;: 0,</span><br><span class="line">            &quot;CpuPercent&quot;: 0,</span><br><span class="line">            &quot;IOMaximumIOps&quot;: 0,</span><br><span class="line">            &quot;IOMaximumBandwidth&quot;: 0,</span><br><span class="line">            &quot;MaskedPaths&quot;: [</span><br><span class="line">                &quot;/proc/asound&quot;,</span><br><span class="line">                &quot;/proc/acpi&quot;,</span><br><span class="line">                &quot;/proc/kcore&quot;,</span><br><span class="line">                &quot;/proc/keys&quot;,</span><br><span class="line">                &quot;/proc/latency_stats&quot;,</span><br><span class="line">                &quot;/proc/timer_list&quot;,</span><br><span class="line">                &quot;/proc/timer_stats&quot;,</span><br><span class="line">                &quot;/proc/sched_debug&quot;,</span><br><span class="line">                &quot;/proc/scsi&quot;,</span><br><span class="line">                &quot;/sys/firmware&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;ReadonlyPaths&quot;: [</span><br><span class="line">                &quot;/proc/bus&quot;,</span><br><span class="line">                &quot;/proc/fs&quot;,</span><br><span class="line">                &quot;/proc/irq&quot;,</span><br><span class="line">                &quot;/proc/sys&quot;,</span><br><span class="line">                &quot;/proc/sysrq-trigger&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;GraphDriver&quot;: &#123;</span><br><span class="line">            &quot;Data&quot;: &#123;</span><br><span class="line">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/f9dc718957db90b4588e60aeced6060e6f0fc605521724e94513c0133f136914-init/diff:/var/lib/docker/overlay2</span><br><span class="line">/ccb1f6f2f87f8be6415039fc26c9997728911e9792b6e13c11633ab40bfb4fdb/diff&quot;,</span><br><span class="line">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/f9dc718957db90b4588e60aeced6060e6f0fc605521724e94513c0133f136914/merged&quot;,</span><br><span class="line">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/f9dc718957db90b4588e60aeced6060e6f0fc605521724e94513c0133f136914/diff&quot;,</span><br><span class="line">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/f9dc718957db90b4588e60aeced6060e6f0fc605521724e94513c0133f136914/work&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;Name&quot;: &quot;overlay2&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Mounts&quot;: [],</span><br><span class="line">        &quot;Config&quot;: &#123;					# 该容器的配置信息</span><br><span class="line">            &quot;Hostname&quot;: &quot;aac0df3b1f54&quot;,		# hostname</span><br><span class="line">            &quot;Domainname&quot;: &quot;&quot;,</span><br><span class="line">            &quot;User&quot;: &quot;&quot;,</span><br><span class="line">            &quot;AttachStdin&quot;: false,</span><br><span class="line">            &quot;AttachStdout&quot;: false,</span><br><span class="line">            &quot;AttachStderr&quot;: false,</span><br><span class="line">            &quot;Tty&quot;: false,</span><br><span class="line">            &quot;OpenStdin&quot;: false,</span><br><span class="line">            &quot;StdinOnce&quot;: false,</span><br><span class="line">            &quot;Env&quot;: [				# 环境变量</span><br><span class="line">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Cmd&quot;: [</span><br><span class="line">                &quot;/bin/sh&quot;,</span><br><span class="line">                &quot;-c&quot;,</span><br><span class="line">                &quot;while true;do echo luyu;sleep 1;done&quot;</span><br><span class="line">            ],</span><br><span class="line">            &quot;Image&quot;: &quot;300e315adb2f&quot;,</span><br><span class="line">            &quot;Volumes&quot;: null,</span><br><span class="line">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Entrypoint&quot;: null,</span><br><span class="line">            &quot;OnBuild&quot;: null,</span><br><span class="line">            &quot;Labels&quot;: &#123;</span><br><span class="line">                &quot;org.label-schema.build-date&quot;: &quot;20201204&quot;,</span><br><span class="line">                &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;,</span><br><span class="line">                &quot;org.label-schema.name&quot;: &quot;CentOS Base Image&quot;,</span><br><span class="line">                &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;,</span><br><span class="line">                &quot;org.label-schema.vendor&quot;: &quot;CentOS&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;   # 关于网络的一些元数据</span><br><span class="line">            &quot;Bridge&quot;: &quot;&quot;,</span><br><span class="line">            &quot;SandboxID&quot;: &quot;f064098b6957297393ae82fffe032e3aa6d1295c5818e195d2221546e520ffa4&quot;,</span><br><span class="line">            &quot;HairpinMode&quot;: false,</span><br><span class="line">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;Ports&quot;: &#123;&#125;,</span><br><span class="line">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/f064098b6957&quot;,</span><br><span class="line">            &quot;SecondaryIPAddresses&quot;: null,</span><br><span class="line">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br><span class="line">            &quot;EndpointID&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPAddress&quot;: &quot;&quot;,</span><br><span class="line">            &quot;IPPrefixLen&quot;: 0,</span><br><span class="line">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">            &quot;MacAddress&quot;: &quot;&quot;,</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;69c5ae2719e4d97b668a69acd2d4e85e66cf6688825c768f8975d3a7eadfa1e8&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 0,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="进入当前正在运行的容器"><a href="#进入当前正在运行的容器" class="headerlink" title="进入当前正在运行的容器"></a>进入当前正在运行的容器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it 容器id /bin/bash     # 进入容器后开启一个新的终端，可以在里面操作（常用）</span><br><span class="line">									# exit后不会停止当前容器</span><br><span class="line"></span><br><span class="line">docker attach 容器id				   # 进入容器正在执行的终端，不会启动新的进程</span><br><span class="line">									# exit后，会立即停止当前的容器</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="从容器内拷贝文件到主机上（反向拷贝也是可以的）"><a href="#从容器内拷贝文件到主机上（反向拷贝也是可以的）" class="headerlink" title="从容器内拷贝文件到主机上（反向拷贝也是可以的）"></a>从容器内拷贝文件到主机上（反向拷贝也是可以的）</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker cp 容器id:容器内的路径 主机目标路径            # 是在主机上完成的，而不是在容器内部</span><br><span class="line"><span class="meta"># </span><span class="language-bash">在home目录下创建File目录，</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">进入容器，并切换到home目录下创建hello.java文件</span></span><br><span class="line">[hadoop@hadoop102 File]$ sudo docker exec -it e3a5ccb43497 /bin/bash</span><br><span class="line">[root@e3a5ccb43497 /]# ls</span><br><span class="line">bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line">[root@e3a5ccb43497 /]# cd home/</span><br><span class="line">[root@e3a5ccb43497 home]# vi hello.java</span><br><span class="line"><span class="meta">#</span><span class="language-bash">退出容器，进入到主机中，进行文件拷贝</span></span><br><span class="line">[hadoop@hadoop102 File]$ sudo docker cp e3a5ccb43497:/home/hello.java ~/File/</span><br><span class="line"><span class="meta"># </span><span class="language-bash">也可以直接拷贝目录</span></span><br><span class="line">[hadoop@hadoop102 File]$ sudo docker cp e3a5ccb43497:/home ~/File/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash">将文件拷贝出来到主机，这是一个手动的过程</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">未来我们使用 -v 卷的技术，可以实现  自动同步  容器内的home目录  与主机的home  连通，打通</span></span><br></pre></td></tr></table></figure>

<h3 id="常用命令小结"><a href="#常用命令小结" class="headerlink" title="常用命令小结"></a>常用命令小结</h3><p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F10379248343%2F0.jpg&refer=http%3A%2F%2Finews.gtimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1626488404&t=24a45ef82f2f339faeffe9c9a29caea6" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/202007171706264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NlZV95b3VfWVU=,size_16,color_FFFFFF,t_70" alt="Docker关系命令图"></p>
<h4 id="容器生命周期管理"><a href="#容器生命周期管理" class="headerlink" title="容器生命周期管理"></a>容器生命周期管理</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-run-command.html">run</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-start-stop-restart-command.html">start/stop/restart</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-kill-command.html">kill</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-rm-command.html">rm</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-pause-unpause-command.html">pause/unpause</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-create-command.html">create</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-exec-command.html">exec</a></li>
</ul>
<h4 id="容器操作"><a href="#容器操作" class="headerlink" title="容器操作"></a>容器操作</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-ps-command.html">ps</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-inspect-command.html">inspect</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-top-command.html">top</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-attach-command.html">attach</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-events-command.html">events</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-logs-command.html">logs</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-wait-command.html">wait</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-export-command.html">export</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-port-command.html">port</a></li>
</ul>
<h4 id="容器rootfs命令"><a href="#容器rootfs命令" class="headerlink" title="容器rootfs命令"></a>容器rootfs命令</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-commit-command.html">commit</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-cp-command.html">cp</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-diff-command.html">diff</a></li>
</ul>
<h4 id="镜像仓库"><a href="#镜像仓库" class="headerlink" title="镜像仓库"></a>镜像仓库</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-login-command.html">login</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-pull-command.html">pull</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-push-command.html">push</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-search-command.html">search</a></li>
</ul>
<h4 id="本地镜像管理"><a href="#本地镜像管理" class="headerlink" title="本地镜像管理"></a>本地镜像管理</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-images-command.html">images</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-rmi-command.html">rmi</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-tag-command.html">tag</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-build-command.html">build</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-history-command.html">history</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-save-command.html">save</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-load-command.html">load</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-import-command.html">import</a></li>
</ul>
<h4 id="info-version"><a href="#info-version" class="headerlink" title="info|version"></a>info|version</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-info-command.html">info</a></li>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/docker/docker-version-command.html">version</a></li>
</ul>
<h2 id="Docker镜像讲解"><a href="#Docker镜像讲解" class="headerlink" title="Docker镜像讲解"></a>Docker镜像讲解</h2><h3 id="镜像是什么？"><a href="#镜像是什么？" class="headerlink" title="镜像是什么？"></a>镜像是什么？</h3><p>镜像是一种轻量级，可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码，运行时、库、环境变量和配置文件。</p>
<p>所有的应用，直接打包docker镜像，就可以直接跑起来！</p>
<p>如何得到镜像：</p>
<ul>
<li>从远程仓库下载</li>
<li>朋友拷贝给你</li>
<li>自己制作一个镜像DockerFile</li>
</ul>
<h3 id="Docker镜像加载原理"><a href="#Docker镜像加载原理" class="headerlink" title="Docker镜像加载原理"></a>Docker镜像加载原理</h3><blockquote>
<p>UnionFS（联合文件系统）</p>
</blockquote>
<p>UnionFS（联合文件系统）：Union文件系统（UnionFS）是一种分层，轻量级并且高性能的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂在到同一个虚拟文件系统。Union文件系统是Docker镜像的基础，镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</p>
<p>特性：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录。</p>
<blockquote>
<p>Docker镜像加载原理</p>
</blockquote>
<p>docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统称为UnionFS。</p>
<p>==bootfs==（boot file system）主要包含bootloader和kernel；bootloader主要是引导加载kernel，Linux刚启动时会加载bootfs文件系统，在Docker镜像的最底层是bootfs。这一层与我们典型的Linux/Unix系统是一样的，包含boot加载器和内核，当boot加载完成之后整个内核就都在内存中了，此时内存的使用权已由bootfs转将给内核，此时系统哦也会卸载bootfs。</p>
<p>==rootfs==在bootfs之上。包含的就是典型Linux系统中的/dev, /proc, /bin, /etc等标准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。</p>
<p><img src="https://s4.51cto.com/images/blog/201711/27/462718f3cd35608c20481b33b09db020.jpg?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="Docker镜像的内部结构(四)"></p>
<p>对于一个精简的OS，rootfs可以很小，只需要包含最基本的命令，工具和程序库就可以了，因为底层直接用Host的kernel，自己只需要提供rootfs就可以了。由此可见对于不同的linux发行版，bootfs基本是一致的，rootfs会有差别，因此不同的发行版可以共用bootfs。</p>
<h3 id="镜像的分层"><a href="#镜像的分层" class="headerlink" title="镜像的分层"></a>镜像的分层</h3><p>通过查看镜像的元数据信息，可以查看到镜像的分层信息。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">docker inspect ubuntu</span></span><br><span class="line">&quot;RootFS&quot;: &#123;</span><br><span class="line">            &quot;Type&quot;: &quot;layers&quot;,</span><br><span class="line">            &quot;Layers&quot;: [</span><br><span class="line">                &quot;sha256:ccdbb80308cc5ef43b605ac28fac29c6a597f89f5a169bbedbb8dec29c987439&quot;,</span><br><span class="line">                &quot;sha256:63c99163f47292f80f9d24c5b475751dbad6dc795596e935c5c7f1c73dc08107&quot;,</span><br><span class="line">                &quot;sha256:2f140462f3bcf8cf3752461e27dfd4b3531f266fa10cda716166bd3a78a19103&quot;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line"><span class="meta"># </span><span class="language-bash">可以看到，rootfs下面显示了镜像的分层信息。</span></span><br></pre></td></tr></table></figure>

<p><strong>理解</strong></p>
<p>所有的Docker镜像都起始于一个基础镜像层，当进行修改或增加新的内容时，就会在当前镜像层之上，创建新的镜像层。举一个简单的例子，假如基于Ubuntu Linux16.04创建一个新的镜像，这就是新镜像的第一层；如果在该镜像中添加了Python包，就会在基础镜像层之上创建第二个镜像层；如果继续添加一个安全补丁，就会创建第三个镜像层。</p>
<p>再添加额外的镜像层的同时，镜像始终保持是当前所有镜像的组合，理解这一点非常重点。</p>
<blockquote>
<p>特点</p>
</blockquote>
<p>Docker镜像都是只读的，当容器启动时，一个新的可写层被加载到镜像的顶部！</p>
<p>这一层就是我们通常说的容器层，容器之下的都叫镜像层！</p>
<h3 id="Commit镜像"><a href="#Commit镜像" class="headerlink" title="Commit镜像"></a>Commit镜像</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">docker commit 提交容器称为一个新的副本</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">命令 和 git原理类似</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker commit -m=<span class="string">&quot;提交的描述信息&quot;</span> -a=<span class="string">&quot;作者&quot;</span> 容器<span class="built_in">id</span>	目标镜像名:[TAG]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">进入容器 ubuntu1</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker <span class="built_in">exec</span> -it ubuntu1 /bin/bash</span> </span><br><span class="line">root@53f02879b24f:/# ls</span><br><span class="line">bin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br><span class="line"><span class="meta"># </span><span class="language-bash">home目录增加文件</span></span><br><span class="line">root@53f02879b24f:/# ls home/</span><br><span class="line">root@53f02879b24f:/# echo &quot;hello world&quot; &gt; home/helloworld.txt</span><br><span class="line">root@53f02879b24f:/# ls home/</span><br><span class="line">helloworld.txt</span><br><span class="line">root@53f02879b24f:/# exit</span><br><span class="line">exit</span><br><span class="line"><span class="meta"># </span><span class="language-bash">提交当前容器，本地会新增一个镜像</span></span><br><span class="line">didi@bogon ~$ docker commit -m=&quot;first commit&quot; -a=&quot;yulu&quot; 53f02879b24f myubuntu:0.1</span><br><span class="line">sha256:cb1d9e8a66a511c5639a5d47a42a0f8949c6ac1e06a96cb9d665036e85609bc9</span><br><span class="line"><span class="meta"># </span><span class="language-bash">查看镜像</span></span><br><span class="line">didi@bogon ~$ docker images</span><br><span class="line">REPOSITORY                TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">myubuntu                  0.1       cb1d9e8a66a5   8 seconds ago   72.7MB # 这就是我们修改后提交的镜像</span><br><span class="line">ubuntu                    latest    7e0aa2d69a15   7 weeks ago     72.7MB</span><br></pre></td></tr></table></figure>

<p><code>如果你想保存当前容器的状态，就可以通过commit来提交，获得一个镜像，就好比VM中的快照</code></p>
<h1 id="Docker进阶学习"><a href="#Docker进阶学习" class="headerlink" title="Docker进阶学习"></a>Docker进阶学习</h1><h2 id="容器数据卷"><a href="#容器数据卷" class="headerlink" title="容器数据卷"></a>容器数据卷</h2><h3 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="headerlink" title="什么是容器数据卷"></a>什么是容器数据卷</h3><p>将应用和环境打包成一个镜像！</p>
<p>数据？如果数据都在容器中，那么我们容器删除之后，这些数据就会丢失！<font color=red>需求：数据可以持久化</font></p>
<p>比如：我们在容器中安装了mysql，存储了一大堆重要的数据，当容器被删除之后，mysql中的数据就随之删除了（删库跑路）==需求：MySql数据可以存储在本地==</p>
<p>容器之间可以有一个数据共享的技术！Docker容器中产生的数据，同步到本地！</p>
<p>这就是卷技术！目录的挂载，将我们容器内的目录，挂在到Linux上面！</p>
<p><font color=green>总结：卷技术可以将容器中的数据持久化和同步到主机上，方便我们对其容器内容的配置文件进行配置和数据备份;容器之间也可以共享数据</font></p>
<h3 id="使用数据卷（-v）"><a href="#使用数据卷（-v）" class="headerlink" title="使用数据卷（-v）"></a>使用数据卷（-v）</h3><blockquote>
<p>方式1：指定文件目录挂载（数据同步是双向的）</p>
<p>主机上被指定的目录应该不存在</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">docker run -it -v 主机目录:容器内目录</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">举个例子：将ubuntu2容器中的home目录挂载到主机的~/docker/data/unbuntu1/home上</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker run -it --name ubuntu2 -v ~/docker/data/ubuntu1/home:/home ubuntu</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">容器内的home目录</span></span><br><span class="line">root@5bf887e2b9e0:/# ls home</span><br><span class="line"><span class="meta"># </span><span class="language-bash">容器外主机上的挂载目录</span></span><br><span class="line">didi@bogon ~$ ls ~/docker/data/ubuntu1/home/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">接下来在容器中添加一个hello.java文件</span></span><br><span class="line">root@5bf887e2b9e0:/# echo &#x27;System.out.println(&quot;hello world!&quot;);&#x27; &gt; home/hello.java</span><br><span class="line">root@5bf887e2b9e0:/# ls home</span><br><span class="line">hello.java</span><br><span class="line"><span class="meta"># </span><span class="language-bash">查看主机上挂载的目录</span></span><br><span class="line">didi@bogon ~$ cat docker/data/ubuntu1/home/hello.java </span><br><span class="line">System.out.println(&quot;hello world!&quot;);</span><br><span class="line"><span class="meta"># </span><span class="language-bash">通过docker inspect 容器<span class="built_in">id</span>  查看容器的元数据信息</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker inspect 5bf887e2b9e0</span></span><br><span class="line">&quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;volume&quot;,				# 卷</span><br><span class="line">                &quot;Name&quot;: &quot;ubuntu3_volume&quot;,		# 卷名</span><br><span class="line">                &quot;Source&quot;: &quot;/var/lib/docker/volumes/ubuntu3_volume/_data&quot;,	# 主机挂载地址</span><br><span class="line">                &quot;Destination&quot;: &quot;/home&quot;,																		# 容器内地址</span><br><span class="line">                &quot;Driver&quot;: &quot;local&quot;,				</span><br><span class="line">                &quot;Mode&quot;: &quot;z&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br></pre></td></tr></table></figure>

<h3 id="具名挂载-与-匿名挂载"><a href="#具名挂载-与-匿名挂载" class="headerlink" title="具名挂载 与 匿名挂载"></a>具名挂载 与 匿名挂载</h3><p>具名挂载和匿名挂载都不需要指定主机的挂载路径。</p>
<p><font color=green>不指定主机的挂载地址，但需要指定容器内需要挂载的地址，如果不存在，会自动创建该目录（文件）</font></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">匿名挂载</span></span><br><span class="line">didi@bogon ~$ docker run -d --name ubuntu4 -v /etc ubuntu</span><br><span class="line">b79600ad36d982e88f18e70059dcb75c8b2ef1e0c646809fff0a526b86199ca7</span><br><span class="line">didi@bogon ~$ docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     c123ec3d50d8cc96802041d60e8a8fcefe03c9d82d23ab7a47a768217380507f  # 匿名卷，没有指定卷的名字</span><br><span class="line"><span class="meta"># </span><span class="language-bash">查看容器的元数据</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker inspect b79600ad36d982e88f18e70059dcb75c8b2ef1e0c646809fff0a526b86199ca7</span></span><br><span class="line">&quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;volume&quot;,</span><br><span class="line">                &quot;Name&quot;: &quot;c123ec3d50d8cc96802041d60e8a8fcefe03c9d82d23ab7a47a768217380507f&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/var/lib/docker/volumes/c123ec3d50d8cc96802041d60e8a8fcefe03c9d82d23ab7a47a768217380507f/_data&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/etc&quot;,</span><br><span class="line">                &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="meta"># </span><span class="language-bash">具名挂载</span></span><br><span class="line">didi@bogon ~$ docker run -d --name ubuntu5 -v ubuntu5_volume:/etc ubuntu</span><br><span class="line">37de88fb243838b931e797ceb271a1bd70e887fb8c399c8f22d70099af770cd2</span><br><span class="line">didi@bogon ~$ docker volume ls</span><br><span class="line">DRIVER    VOLUME NAME</span><br><span class="line">local     ubuntu5_volume</span><br><span class="line">didi@bogon ~$ docker inspect 37de88fb243838b931e797ceb271a1bd70e887fb8c399c8f22d70099af770cd2</span><br><span class="line">&quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;volume&quot;,</span><br><span class="line">                &quot;Name&quot;: &quot;ubuntu5_volume&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/var/lib/docker/volumes/ubuntu5_volume/_data&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/etc&quot;,</span><br><span class="line">                &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;z&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line"><span class="meta"># </span><span class="language-bash">查看卷的元数据信息</span></span><br><span class="line">didi@bogon ~$ docker volume inspect ubuntu5_volume</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;CreatedAt&quot;: &quot;2021-06-16T14:12:33Z&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Labels&quot;: null,</span><br><span class="line">        &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/ubuntu5_volume/_data&quot;,</span><br><span class="line">        &quot;Name&quot;: &quot;ubuntu5_volume&quot;,</span><br><span class="line">        &quot;Options&quot;: null,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"><span class="meta"># </span><span class="language-bash">挂载的时候，可以指定读写权限；ro：只读； rw：读写</span></span><br></pre></td></tr></table></figure>



<p>DockerFile的方式也可以指定数据卷，将容器内的目录挂载到主机上（宿主机上）</p>
<h3 id="数据卷容器（容器与容器之间共享数据卷）"><a href="#数据卷容器（容器与容器之间共享数据卷）" class="headerlink" title="数据卷容器（容器与容器之间共享数据卷）"></a>数据卷容器（容器与容器之间共享数据卷）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">数据卷选项   --volume-from</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker run -it --name docker2 --volume-from docker1 ubuntu  <span class="comment">#  容器docker2 同步（继承）容器docker1的数据卷，docker1就是数据卷容器</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>==数据共享，如果数据卷容器停止了且删除了，你猜其他挂载这个容器的中的数据还会存在吗？？？？？  答案是肯定存在啊==</p>
<p><font color=red>特别说明：</font></p>
<blockquote>
<p>docker中的数据共享，数据卷技术是通过拷贝的技术来实现，如果其中挂载的容器被删除了，但是被挂载的目录因为复制了容器中的数据，所以在容器被删除之后，还是会存才相应的数据的。</p>
</blockquote>
<p><strong>小结</strong></p>
<p>容器之间配置信息的传递，数据卷容器的生命周期一直持续到没有容器使用为止。</p>
<p>但是你一旦持久化到了本地，这个时候，本地的数据是不会删除的。</p>
<h2 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h2><h3 id="DockerFile介绍"><a href="#DockerFile介绍" class="headerlink" title="DockerFile介绍"></a>DockerFile介绍</h3><p>dockerfile是用来构建docker镜像的文件！命令参数脚本！</p>
<p><strong>构建步骤：</strong></p>
<ol>
<li>编写一个dockerfile文件</li>
<li>使用docker build 构建成为一个镜像</li>
<li>docker run 运行镜像</li>
<li>docker push 发布镜像（DockerHub、阿里云镜像仓库！）</li>
</ol>
<blockquote>
<p>很多官方镜像都是基础包，很多功能没有（常用的命令也可能没有），我们通常会自己搭建自己的镜像！</p>
</blockquote>
<h3 id="DockerFile构建过程"><a href="#DockerFile构建过程" class="headerlink" title="DockerFile构建过程"></a>DockerFile构建过程</h3><p><strong>基础知识</strong></p>
<ol>
<li>每个保留关键字（指令）都必须是大写字母</li>
<li>执行从上到下顺序执行</li>
<li>#：表示注释</li>
<li>每一个指令都会创建提交一个新的镜像层，并提交</li>
</ol>
<img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.liuhaihua.cn%2Fwp-content%2Fuploads%2F2016%2F08%2FMFB3Yjf.jpg&refer=http%3A%2F%2Fwww.liuhaihua.cn&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1626488126&t=67aeecd77f39cae1d12bb367c661085f" alt="img" style="zoom:50%;" />

<p>dockerfile是面向开发的，我们以后要发布项目，做镜像，就需要编写dockerfile文件，这个文件十分简单！</p>
<p>Docker镜像逐渐成为企业交付的标准，必须要掌握！</p>
<p><strong>三部曲</strong>：开发、部署、运维</p>
<ol>
<li>DockerFile：构建文件，定义了一切的步骤，源代码</li>
<li>DockerImages：通过DockerFile构建生成的镜像，最终发布和运行的产品</li>
<li>Docker容器：容器就是镜像运行起来提供服务器</li>
</ol>
<h3 id="DockerFile指令"><a href="#DockerFile指令" class="headerlink" title="DockerFile指令"></a>DockerFile指令</h3><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimg.dongcoder.com%2Fup%2Finfo%2F201912%2F20191201213114965392.png&refer=http%3A%2F%2Fimg.dongcoder.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1626488249&t=cd0fff660b8407d3f0dbf318766d3a1f" alt="img" style="zoom:%;" />



<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FROM					# 基础镜像，一切从这里开始构建</span><br><span class="line">MAINTAINER		# 镜像是谁写的， 姓名+邮箱</span><br><span class="line">RUN						# 镜像构建的时候需要运行的命令</span><br><span class="line">ADD						# 步骤，tomcat镜像，这个tomcat压缩包！   自动解压</span><br><span class="line">WORKDIR				# 镜像的工作目录   进入容器的时候，默认的工作空间</span><br><span class="line">VOLUME				# 挂载的目录</span><br><span class="line">EXPOSE				# 保留端口配置</span><br><span class="line">CMD						# 指定这个容器启动的时候要执行的命令。只有最后一个会生效，可被替代</span><br><span class="line">ENTRYPOINT		# 指定这个容器启动的时候要运行的命令。可以追加命</span><br><span class="line">ONBUILD				# 当构建一个被继承DockerFile 这个时候就会运行 ONBUILD 的指令。 触发指令</span><br><span class="line">COPY					# 累计ADD，将文件拷贝到镜像中   仅仅拷贝，不解压</span><br><span class="line">ENV						# 构建的时候设置环境变量！</span><br></pre></td></tr></table></figure>

<p><img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fseo-1255598498.file.myqcloud.com%2Ffull%2F4455082961bc017cb7c87a3463bb326e021013ce.jpg&refer=http%3A%2F%2Fseo-1255598498.file.myqcloud.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1626488342&t=d082a7ddde61f3208268b222179c264f" alt="img"></p>
<h4 id="构建DockerFile之前的说明"><a href="#构建DockerFile之前的说明" class="headerlink" title="构建DockerFile之前的说明"></a><strong>构建DockerFile之前的说明</strong></h4><blockquote>
<p>Docker 通过DockerFile构建镜像的时候，Docker的守护进程会将当前目录下的所有文件打包到镜像中；就像我们使用git add .  会将当前目录下的所有文件加入到暂存区。但是可以通过指定.ignore文件进行选择性忽略。</p>
<p>Docker也支持类似的操作；</p>
<p>可以通过编写 <code>.dockerignore</code>文件来进行选择过滤掉一些我们不想打包到镜像中的文件，尽量保证镜像的精简。</p>
</blockquote>
<h4 id="Docker构建DockerFile命令"><a href="#Docker构建DockerFile命令" class="headerlink" title="Docker构建DockerFile命令"></a>Docker构建DockerFile命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">1. 通常我们会创建一个空的目录，这个目录下我们存放一些我们需要构建的文件，比如MySql，tomcat等的安装包， 还有一些必备的文件</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">2. 我们可以自定义DockerFile的文件名，但是如果直接定义成DockerFile，我们在执行build命令的时候，就不需要指定改文件的路径位置，否则需要通过-f选项执行具体的DockerFile文件的路径</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker build -f DockerFile_Path -t luyu/myapp:1.0.2 -t luyu/myapp:latest</span></span><br><span class="line">-f: 指定DockerFile文件的路径</span><br><span class="line">-t: 指定生成的image镜像的目标位置</span><br></pre></td></tr></table></figure>

<h4 id="DockerFile-Centos官方样例"><a href="#DockerFile-Centos官方样例" class="headerlink" title="DockerFile Centos官方样例"></a>DockerFile Centos官方样例</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">官方centos的DockerFile</span></span><br><span class="line">FROM scratch</span><br><span class="line">ADD centos-7-x86_64-docker.tar.xz /</span><br><span class="line"></span><br><span class="line">LABEL \</span><br><span class="line">    org.label-schema.schema-version=&quot;1.0&quot; \</span><br><span class="line">    org.label-schema.name=&quot;CentOS Base Image&quot; \</span><br><span class="line">    org.label-schema.vendor=&quot;CentOS&quot; \</span><br><span class="line">    org.label-schema.license=&quot;GPLv2&quot; \</span><br><span class="line">    org.label-schema.build-date=&quot;20201113&quot; \</span><br><span class="line">    org.opencontainers.image.title=&quot;CentOS Base Image&quot; \</span><br><span class="line">    org.opencontainers.image.vendor=&quot;CentOS&quot; \</span><br><span class="line">    org.opencontainers.image.licenses=&quot;GPL-2.0-only&quot; \</span><br><span class="line">    org.opencontainers.image.created=&quot;2020-11-13 00:00:00+00:00&quot;</span><br><span class="line"></span><br><span class="line">CMD [&quot;/bin/bash&quot;]</span><br></pre></td></tr></table></figure>

<p><font color=green>通常情况下，build DockerFile，都会指定这个要构建的镜像的bootfs的来源（换句话说，就是要指定这个镜像是从哪个基础镜像构建的, 也就是指定 <strong>父镜像</strong>）</font></p>
<h4 id="DockerFile中的关键字说明"><a href="#DockerFile中的关键字说明" class="headerlink" title="DockerFile中的关键字说明"></a>DockerFile中的关键字说明</h4><p>虽然在dockerfile中支持关键字小写，但是为了区分参数，尽量保持关键字大写，参数小写</p>
<h5 id="FROM"><a href="#FROM" class="headerlink" title="FROM"></a>FROM</h5><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt; [AS &lt;name&gt;]</span><br><span class="line"><span class="keyword">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt;[:&lt;tag&gt;] [AS &lt;name&gt;]</span><br><span class="line"><span class="keyword">FROM</span> [--platform=&lt;platform&gt;] &lt;image&gt;[@&lt;digest&gt;] [AS &lt;name&gt;]</span><br></pre></td></tr></table></figure>

<h6 id="ARG和FROM"><a href="#ARG和FROM" class="headerlink" title="ARG和FROM"></a>ARG和FROM</h6><p>虽然说DockerFile都是一FROM关键字开头的，但是可以在FROM前声明一个或者多个ARG指令。ARG指令可以定义变量，例如TAG信息</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ARG</span>  CODE_VERSION=latest</span><br><span class="line"><span class="keyword">FROM</span> base:$&#123;CODE_VERSION&#125;</span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash">  /code/run-app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> extras:$&#123;CODE_VERSION&#125;</span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash">  /code/run-extras</span></span><br></pre></td></tr></table></figure>

<p>==特别说明==</p>
<p>FROM在同一个DockerFile文件中可以出现一次或多次</p>
<p>当出现多次的时候，可以构建多个镜像；或者一个镜像作为另一个镜像的<strong>父依赖</strong>。可以通过AS关键字为FROM起一个别名</p>
<h5 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h5><p>镜像构建的时时候运行指定命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">一般RUN 有两种格式运行命令   shell format  和  <span class="built_in">exec</span> format</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">第一种方式可通过 \ 进行换行</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">RUN /bin/bash -c <span class="string">&#x27;source $HOME/.bashrc; \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">echo $HOME&#x27;</span></span></span><br><span class="line"><span class="meta">#</span><span class="language-bash"><span class="comment">#########################</span></span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">RUN [<span class="string">&quot;/bin/bash&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;echo hello&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<p><font color=red>关于RUN关键字执行命令的时候的注意事项</font></p>
<p>镜像构建的时候，是按照层级构建的。如果构建到当前层的时候，发现之前已经构建过相同的层，这时就会复用历史层，而不会再执行当前层了！</p>
<p>如果使用 <code>apt-get update</code> 与 <code>apt-get install</code>命令就需要特别注意，尽量将<code>apt-get update</code> 与 <code>apt-get install</code> 放到一个RUN层。</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y \</span></span><br><span class="line"><span class="language-bash">    aufs-tools \</span></span><br><span class="line"><span class="language-bash">    automake \</span></span><br><span class="line"><span class="language-bash">    build-essential \</span></span><br><span class="line"><span class="language-bash">    curl \</span></span><br><span class="line"><span class="language-bash">    dpkg-sig \</span></span><br><span class="line"><span class="language-bash">    libcap-dev \</span></span><br><span class="line"><span class="language-bash">    libsqlite3-dev \</span></span><br><span class="line"><span class="language-bash">    mercurial \</span></span><br><span class="line"><span class="language-bash">    reprepro \</span></span><br><span class="line"><span class="language-bash">    ruby1.9.1 \</span></span><br><span class="line"><span class="language-bash">    ruby1.9.1-dev \</span></span><br><span class="line"><span class="language-bash">    s3cmd=1.1.* \</span></span><br><span class="line"><span class="language-bash"> &amp;&amp; <span class="built_in">rm</span> -rf /var/lib/apt/lists/*</span></span><br></pre></td></tr></table></figure>

<p>如果不放到同一个RUN中，例如下面这段dockerfile</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 刚开始的时候，我们通过以下命令，进行构建，但是还想安装nginx，</span></span><br><span class="line"><span class="comment"># syntax=docker/dockerfile:1</span></span><br><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">18.04</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y curl</span></span><br><span class="line"><span class="comment"># 又在右面添加</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get install -y curl nginx</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>上述两端命令，第二段命令中的 <code>apt-get update</code> 不会再执行了，因为在Docker的缓存看来，这一层之前已经构建过了，就复用了之前层的 <code>apt-get update</code></p>
<p>这就有可能导致之前的update之后没有nginx，这就会导致<code>RUN apt-get install -y curl nginx</code>运行失败！</p>
<p>所及尽量保证在一层RUN中执行，避免这种情况的发生。</p>
</blockquote>
<h5 id="CMD-与-ENTRYPOINT"><a href="#CMD-与-ENTRYPOINT" class="headerlink" title="CMD 与 ENTRYPOINT"></a>CMD 与 ENTRYPOINT</h5><p>CMD 与 ENTRYPOINT关键字都可能指定以该DockerFile构建的镜像创建的容器在启动的时候要执行的命令。</p>
<p>区别在于：CMD指定的命令，会因为我们在执行<code>docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</code>时人为指定的<code>COMMAND</code>要执行命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">创建一个DockerFile文件，末尾指定一个CMD [<span class="string">&#x27;ls&#x27;</span>]</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash"><span class="built_in">cat</span> DockerFile</span> </span><br><span class="line">FROM	centos</span><br><span class="line">RUN		echo &quot;hello world&quot;;</span><br><span class="line">CMD		[&#x27;ls&#x27;]</span><br><span class="line"><span class="meta"># </span><span class="language-bash">然后build dockerfile文件</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker build -f ./DockerFile -t luyu/firstimages:1.0.1 .</span></span><br><span class="line">[+] Building 0.1s (6/6) FINISHED                                                                                                     </span><br><span class="line"> =&gt; [internal] load build definition from DockerFile                                                                            0.0s</span><br><span class="line"> =&gt; =&gt; transferring dockerfile: 91B                                                                                             0.0s</span><br><span class="line"> =&gt; [internal] load .dockerignore                                                                                               0.0s</span><br><span class="line"> =&gt; =&gt; transferring context: 2B                                                                                                 0.0s</span><br><span class="line"> =&gt; [internal] load metadata for docker.io/library/centos:latest                                                                0.0s</span><br><span class="line"> =&gt; [1/2] FROM docker.io/library/centos                                                                                         0.0s</span><br><span class="line"> =&gt; CACHED [2/2] RUN  ECHO &quot;hello world&quot;;                                                                                       0.0s</span><br><span class="line"> =&gt; exporting to image                                                                                                          0.0s</span><br><span class="line"> =&gt; =&gt; exporting layers                                                                                                         0.0s</span><br><span class="line"> =&gt; =&gt; writing image sha256:c3e7f267d07123989d20e73d1772247cc1d7a83b068225f507f6f639d5e5ec70                                    0.0s</span><br><span class="line"> =&gt; =&gt; naming to docker.io/luyu/firstimages:1.0.1                                                                               0.0s</span><br><span class="line"></span><br><span class="line">Use &#x27;docker scan&#x27; to run Snyk tests against images to find vulnerabilities and learn how to fix them</span><br><span class="line"><span class="meta"># </span><span class="language-bash">后台启动一个该镜像的容器</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker run -d c3e7f267d07123989d20e73d1772247cc1d7a83b068225f507f6f639d5e5ec70</span></span><br><span class="line">4fead54e8978e1a4be2f2457845d144ec428135b3367ccfc1a47ef9ab0ba49dc</span><br><span class="line"><span class="meta"># </span><span class="language-bash">查看该容器的日志</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker logs 4fead54e8978e1a4be2f2457845d144ec428135b3367ccfc1a47ef9ab0ba49dc</span></span><br><span class="line">/bin/sh: [ls]: command not found   # 这行证明CMD内的指令已经执行了，但是提示没有找到ls命令</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">然后后台再启动一个容器。并指定要执行的命令  <span class="built_in">ls</span> -al</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker run -d c3e7f267d07123989d20e73d1772247cc1d7a83b068225f507f6f639d5e5ec70 <span class="built_in">ls</span> -al</span></span><br><span class="line">a19557b0b538ba0cb75579d0e81d1fccf8d03053dff717bc670de0e6889ae467</span><br><span class="line"><span class="meta"># </span><span class="language-bash">再次查看容器日志</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker logs a19557b0b538ba0cb75579d0e81d1fccf8d03053dff717bc670de0e6889ae467</span></span><br><span class="line">total 56</span><br><span class="line">drwxr-xr-x   1 root root 4096 Jun 18 09:40 .</span><br><span class="line">drwxr-xr-x   1 root root 4096 Jun 18 09:40 ..</span><br><span class="line">-rwxr-xr-x   1 root root    0 Jun 18 09:40 .dockerenv</span><br><span class="line">lrwxrwxrwx   1 root root    7 Nov  3  2020 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x   5 root root  340 Jun 18 09:40 dev</span><br><span class="line">drwxr-xr-x   1 root root 4096 Jun 18 09:40 etc</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 home</span><br><span class="line">lrwxrwxrwx   1 root root    7 Nov  3  2020 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx   1 root root    9 Nov  3  2020 lib64 -&gt; usr/lib64</span><br><span class="line">drwx------   2 root root 4096 Dec  4  2020 lost+found</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 media</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 mnt</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 opt</span><br><span class="line">dr-xr-xr-x 185 root root    0 Jun 18 09:40 proc</span><br><span class="line">dr-xr-x---   2 root root 4096 Dec  4  2020 root</span><br><span class="line">drwxr-xr-x  11 root root 4096 Dec  4  2020 run</span><br><span class="line">lrwxrwxrwx   1 root root    8 Nov  3  2020 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x   2 root root 4096 Nov  3  2020 srv</span><br><span class="line">dr-xr-xr-x  13 root root    0 Jun 18 09:40 sys</span><br><span class="line">drwxrwxrwt   7 root root 4096 Dec  4  2020 tmp</span><br><span class="line">drwxr-xr-x  12 root root 4096 Dec  4  2020 usr</span><br><span class="line">drwxr-xr-x  20 root root 4096 Dec  4  2020 var</span><br><span class="line"><span class="meta"># </span><span class="language-bash">从上述结果可以看出，启动容器的时候， 人为指定的命令  覆盖了DockerFile文件中指定的  CMD命令</span></span><br></pre></td></tr></table></figure>

<p>而<strong>ENTRYPOINT</strong>关键字指定的命令不会被覆盖，人为指定的命令会追加到后面</p>
<p>可以使用<strong>ENTRYPOINT</strong>作为镜像的主命令，然后<strong>CMD</strong>作为默认命令</p>
<p>例子：</p>
<p>本地有一个shell脚本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">set -e</span><br><span class="line"></span><br><span class="line">if [ &quot;$1&quot; = &#x27;postgres&#x27; ]; then</span><br><span class="line">    chown -R postgres &quot;$PGDATA&quot;</span><br><span class="line"></span><br><span class="line">    if [ -z &quot;$(ls -A &quot;$PGDATA&quot;)&quot; ]; then</span><br><span class="line">        gosu postgres initdb</span><br><span class="line">    fi</span><br><span class="line"></span><br><span class="line">    exec gosu postgres &quot;$@&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">exec &quot;$@&quot;</span><br></pre></td></tr></table></figure>

<p>复制脚本至容器内</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./docker-entrypoint.sh \</span></span><br><span class="line"><span class="language-bash">ENTRYPOINT [<span class="string">&quot;/docker-entrypoint.sh&quot;</span>]</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;postgres&quot;</span>]</span></span><br></pre></td></tr></table></figure>



<h5 id="EXPOSE"><a href="#EXPOSE" class="headerlink" title="EXPOSE"></a>EXPOSE</h5><p>EXPOSE 可以人为的暴露容器的端口，方便在启动容器的时候，进行端口随机映射</p>
<h5 id="ENV"><a href="#ENV" class="headerlink" title="ENV"></a>ENV</h5><p>ENV可以设置容器内部的环境变量，例如：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENV</span> PATH=/usr/local/nginx/bin:$PATH  <span class="comment"># 以确保CMD [&quot;nginx&quot;] 正常工作</span></span><br></pre></td></tr></table></figure>



<h5 id="ADD和COPY"><a href="#ADD和COPY" class="headerlink" title="ADD和COPY"></a>ADD和COPY</h5><p>ADD和COPY都可以将文件添加到容器内，虽然二者相似，但又有不同之处；</p>
<ul>
<li>COPY是单纯的将本地文件复制到容器内</li>
<li>ADD条件本地文件时，如果是压缩包，会自动解压</li>
</ul>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> requirements.txt /tmp/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip install --requirement /tmp/requirements.txt</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . /tmp/</span></span><br></pre></td></tr></table></figure>

<p><font color=red>注意：实际使用过程中</font></p>
<p><font color=blue>ADD相对于COPY来说，不透明，实际使用应该避免使用ADD关键</font></p>
<p>​        <font color=red>替代方案：</font></p>
<p>​                        可以先COPY到容器内，然后通过RUN进行解压，或者通过<code>curl</code>或<code>wget</code>将压缩包下载到本地之后在进行解压</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="language-bash"> big.tar.xz /tmp/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash">  tar -xJf /tmp/big.tar.xz -C /usr/src/things \</span></span><br><span class="line"><span class="language-bash">			&amp;&amp; make -C /usr/src/things all</span></span><br></pre></td></tr></table></figure>

<p>对于不需要ADD tar自动提取功能的其他项目（文件、目录），应该始终使用 COPY</p>
<h5 id="VOLUME"><a href="#VOLUME" class="headerlink" title="VOLUME"></a>VOLUME</h5><p>dockerfile中的<code>VOLUME</code>关键字可以挂载容器内目录到主机目录，通过匿名挂载的方式。可以通过<code>docker inspect 容器id</code>查看挂载到主机的实际目录在哪里</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> /myvol</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;hello world&quot;</span> &gt; /myvol/greeting</span></span><br><span class="line"><span class="keyword">VOLUME</span><span class="language-bash"> /myvol  <span class="comment"># 通过匿名挂载的方式挂载容器内   /myvol 目录</span></span></span><br></pre></td></tr></table></figure>























































<h2 id="Docker网络"><a href="#Docker网络" class="headerlink" title="Docker网络"></a>Docker网络</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/22a7032bb7bd">Docker的四种网络模式</a></p>
<p>docker的网络模式支持4种：</p>
<ol>
<li>host模式（仅主机模式）</li>
<li>container模式（用的少！局限性很大）</li>
<li>none模式：不配置网络</li>
<li>bridge模式（默认的模式）</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">docker network <span class="built_in">ls</span> <span class="comment"># 可以查看docker的所有网络信息</span></span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker network <span class="built_in">ls</span></span></span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">37f1233b03fe   bridge    bridge    local</span><br><span class="line">dddd641e9fee   host      host      local</span><br><span class="line">1bd165c33f9d   none      null      local</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">docker network --<span class="built_in">help</span></span></span><br><span class="line"></span><br><span class="line">Usage:  docker network COMMAND</span><br><span class="line"></span><br><span class="line">Manage networks</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  connect     Connect a container to a network</span><br><span class="line">  create      Create a network</span><br><span class="line">  disconnect  Disconnect a container from a network</span><br><span class="line">  inspect     Display detailed information on one or more networks</span><br><span class="line">  ls          List networks</span><br><span class="line">  prune       Remove all unused networks</span><br><span class="line">  rm          Remove one or more networks</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="理解Docker0"><a href="#理解Docker0" class="headerlink" title="理解Docker0"></a>理解Docker0</h3><p>清空所有环境</p>
<p>Docker是如何处理容器网络访问的?</p>
<h4 id="bridge模式"><a href="#bridge模式" class="headerlink" title="bridge模式"></a>bridge模式</h4><img src="https://upload-images.jianshu.io/upload_images/13618762-f1643a51d313a889.png?imageMogr2/auto-orient/strip|imageView2/2/w/1083/format/webp" alt="img" style="zoom:50%;" />



<ol>
<li>先查看本机网卡信息</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">主机ip信息</span></span><br><span class="line">[root@hadoop102 hadoop]# ip addr</span><br><span class="line"><span class="meta"># </span><span class="language-bash">自环地址</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 00:0c:29:50:e3:01 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    # ens33 网卡ip地址</span><br><span class="line">    inet 192.168.70.102/24 brd 192.168.70.255 scope global noprefixroute ens33</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::20c:29ff:fe50:e301/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: virbr0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000</span><br><span class="line">    link/ether 52:54:00:f2:8e:d9 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">4: virbr0-nic: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc pfifo_fast master virbr0 state DOWN group default qlen 1000</span><br><span class="line">    link/ether 52:54:00:f2:8e:d9 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">5: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default </span><br><span class="line">    link/ether 02:42:2f:c2:0c:74 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    # docker0 网络</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::42:2fff:fec2:c74/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta"># </span><span class="language-bash">容器内的ip地址信息</span></span><br><span class="line">[root@hadoop102 hadoop]# docker exec -it tomcat01 ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta"># </span><span class="language-bash">evth-pair  34--35</span></span><br><span class="line">34: eth0@if35: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default </span><br><span class="line">    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">容器开启后，主机多出一块网卡   35 -- 34</span></span><br><span class="line">35: veth35da31e@if34: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master docker0 state UP group default </span><br><span class="line">    link/ether 0e:cc:1b:7b:3b:27 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">    inet6 fe80::ccc:1bff:fe7b:3b27/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>我们发现，容器带来的网卡，都是成对出现的（成对儿的虚拟设备接口）</p>
<p>veth-pair 就是一对的虚拟设备接口，它们都是成对儿出现的，一端连着协议，一端彼此相连</p>
<p>正因为这个特性，veth-pair充当一个桥梁，连接各种虚拟网络设备的</p>
<p>docker 中的所有网络接口都是虚拟的，虚拟的转发效率高</p>
</blockquote>
<p><strong>小总结</strong>：容器都是公用一个路由器的，就是这个docke0，在bridge模式下也称之为桥</p>
<h3 id="容器互联"><a href="#容器互联" class="headerlink" title="容器互联"></a>容器互联</h3><h4 id="–link（不推荐使用）"><a href="#–link（不推荐使用）" class="headerlink" title="–link（不推荐使用）"></a>–link（不推荐使用）</h4><blockquote>
<p>思考一个场景，我们编写一个微服务， database url=ip:端口号 ，项目重启时，ip地址就会变化，可不可以通过名字来访问容器的ip地址，这样就可以保证虽然ip地址在变化，但是名字一直不会变？</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 hadoop]# docker exec -it tomcat02 ping tomcat01</span><br><span class="line">ping: tomcat01: Name or service not known</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">通过 --<span class="built_in">link</span>可以连通两个容器，进而通过容器名就可以相互ping同</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker run -d --name tomcat03 --<span class="built_in">link</span> tomcat01 tomcat</span></span><br><span class="line">11145388c943701718c7baa9c2b291a1c2f72b9845709fe098066d7bd3005038</span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker <span class="built_in">exec</span> -it tomcat03 ping tomcat01</span></span><br><span class="line">PING tomcat01 (172.17.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from tomcat01 (172.17.0.2): icmp_seq=1 ttl=64 time=0.168 ms</span><br><span class="line">64 bytes from tomcat01 (172.17.0.2): icmp_seq=2 ttl=64 time=0.061 ms</span><br><span class="line">64 bytes from tomcat01 (172.17.0.2): icmp_seq=3 ttl=64 time=0.061 ms</span><br><span class="line"><span class="meta"># </span><span class="language-bash">反向ping 却ping不通</span></span><br><span class="line">docker exec -it tomcat01 ping tomcat03</span><br><span class="line">ping: tomcat03: Name or service not known</span><br></pre></td></tr></table></figure>

<p><strong>底层探究</strong></p>
<p>–link 选项可以更改容器的hosts文件，将被链接的容器的ip与容器名字和 ip进行<strong>映射</strong>；但是这个过程是<strong>单向的</strong></p>
<p><font color=red>–link已经不推荐使用了</font>，可以通过自定义网络，不直接使用docker0.</p>
<p>例如docker0的问题： 不支持容器名链接访问</p>
<h4 id="自定义网络"><a href="#自定义网络" class="headerlink" title="自定义网络"></a>自定义网络</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">docker run 的时候，默认会添加一个 --net bridge的选项，这里的bridge就是创建的网络名</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker run -d --name tomcat01 --net bridge tomcat</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">docker0特点： 默认、域名不能访问、 --<span class="built_in">link</span>可以打通连接，但是笨重，不灵活</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">通过自定义网络，可实现容器的域名连接</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">接下来创建一个网络mynet</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span></span><br><span class="line">bb4918b73768c514519787fe74308638384ea49d79f1cc55b9df330b5a36a0ad</span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker network <span class="built_in">ls</span></span></span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">37f1233b03fe   bridge    bridge    local</span><br><span class="line">dddd641e9fee   host      host      local</span><br><span class="line">bb4918b73768   mynet     bridge    local # 自定义创建的网络，相当于我们自己创建了一个桥</span><br><span class="line">1bd165c33f9d   none      null      local</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">启动两个容器，都指定相同的网络</span></span><br><span class="line">[root@hadoop102 hadoop]$ docker run -d --name tomcat01 --net mynet tomcat</span><br><span class="line">3dc2a40323a1272adca27ea381a1038a27a176dc3dbdc07ab7a1a03ed83ef5b7</span><br><span class="line">[root@hadoop102 hadoop]$ docker run -d --name tomcat02 --net mynet tomcat</span><br><span class="line">9c0be98e171d19eb4d1db49f11b8936a79f41d8aa91052b96572a917de668bdd</span><br><span class="line">[root@hadoop102 hadoop]$ docker network inspect mynet</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;bb4918b73768c514519787fe74308638384ea49d79f1cc55b9df330b5a36a0ad&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2021-06-19T10:54:35.743318807+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;</span><br><span class="line">            &quot;3dc2a40323a1272adca27ea381a1038a27a176dc3dbdc07ab7a1a03ed83ef5b7&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat01&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;c76434e3d13f2b5b279404afa70b088eb5f054fb30701b14218d77fdf46f46c8&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:02&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.2/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;9c0be98e171d19eb4d1db49f11b8936a79f41d8aa91052b96572a917de668bdd&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat02&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;68b1c4c037eae586663d693447d49fe29736ebc0fcf1c89e1407c3c651a4d79f&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:03&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.3/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"><span class="meta"># </span><span class="language-bash">使用自定义网络之后，不仅可以自动的能进行域名的映射，而且还能双向ping通</span></span><br><span class="line">[root@hadoop102 hadoop]$ docker exec -it tomcat01 ping tomcat02</span><br><span class="line">PING tomcat02 (192.168.0.3) 56(84) bytes of data.</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=1 ttl=64 time=0.172 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=2 ttl=64 time=0.117 ms</span><br><span class="line">64 bytes from tomcat02.mynet (192.168.0.3): icmp_seq=3 ttl=64 time=0.088 ms</span><br><span class="line">^C</span><br><span class="line">--- tomcat02 ping statistics ---</span><br><span class="line">3 packets transmitted, 3 received, 0% packet loss, time 6ms</span><br><span class="line">rtt min/avg/max/mdev = 0.088/0.125/0.172/0.037 ms</span><br><span class="line">[root@hadoop102 hadoop]$ docker exec -it tomcat02 ping tomcat01</span><br><span class="line">PING tomcat01 (192.168.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from tomcat01.mynet (192.168.0.2): icmp_seq=1 ttl=64 time=0.206 ms</span><br><span class="line">64 bytes from tomcat01.mynet (192.168.0.2): icmp_seq=2 ttl=64 time=0.061 ms</span><br><span class="line">64 bytes from tomcat01.mynet (192.168.0.2): icmp_seq=3 ttl=64 time=0.062 ms</span><br><span class="line">^C</span><br><span class="line">--- tomcat01 ping statistics ---</span><br><span class="line">3 packets transmitted, 3 received, 0% packet loss, time 4ms</span><br><span class="line">rtt min/avg/max/mdev = 0.061/0.109/0.206/0.069 ms</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>使用自定义网络的好处：</p>
<ol>
<li>redis - 不同的集群使用不同的网络，保证集群是安全和健康的 </li>
<li>mysql - 不同的集群使用不同的网络，保证集群是安全和健康的</li>
</ol>
<h4 id="网络连通"><a href="#网络连通" class="headerlink" title="网络连通"></a>网络连通</h4><p>处于不同网桥下的两个容器如何连通？</p>
<p>   <img src="C:\Users\LuYu\AppData\Roaming\Typora\typora-user-images\image-20210619121627000.png" alt="image-20210619121627000"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">docker network --<span class="built_in">help</span></span></span><br><span class="line"></span><br><span class="line">Usage:  docker network COMMAND</span><br><span class="line"></span><br><span class="line">Manage networks</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line">  connect     Connect a container to a network  # 连接一个容器到一个网络</span><br><span class="line">  create      Create a network</span><br><span class="line">  disconnect  Disconnect a container from a network</span><br><span class="line">  inspect     Display detailed information on one or more networks</span><br><span class="line">  ls          List networks</span><br><span class="line">  prune       Remove all unused networks</span><br><span class="line">  rm          Remove one or more networks</span><br><span class="line"><span class="meta"># </span><span class="language-bash">用法</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker network connect --<span class="built_in">help</span></span></span><br><span class="line"></span><br><span class="line">Usage:  docker network connect [OPTIONS] NETWORK CONTAINER</span><br><span class="line"></span><br><span class="line">Connect a container to a network</span><br><span class="line"></span><br><span class="line">Options:</span><br><span class="line">      --alias strings           Add network-scoped alias for the container</span><br><span class="line">      --driver-opt strings      driver options for the network</span><br><span class="line">      --ip string               IPv4 address (e.g., 172.30.100.104)</span><br><span class="line">      --ip6 string              IPv6 address (e.g., 2001:db8::33)</span><br><span class="line">      --link list               Add link to another container</span><br><span class="line">      --link-local-ip strings   Add a link-local address for the container</span><br><span class="line"><span class="meta"># </span><span class="language-bash">假设有两个不同网桥 docker0  和  mynet</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">docker0上有一个容器 tomcat01   mynet上有一个容器tomcat-net-01</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">网络连通这两个容器</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">docker network connect mynet tomcat01</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">实质上是把容器tomcat01的网络信息添加到了网桥mynet中，因此这个过程是单向，tomcat01能ping通tomcat-net-01</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">但是tomcat-net-01 ping不通tomcat01</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">产生的效果就是：tomcat01这个容器会有两个ip地址，一个是公网ip地址，一个是内网IP地址</span></span><br></pre></td></tr></table></figure>





<h2 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h2><blockquote>
<p>官方介绍</p>
</blockquote>
<p>Compose使用一个用于<strong>定义</strong>和<strong>运行</strong>多个容器应用的工具</p>
<p>使用YAML文件配置应用的服务，通过这个配置文件可<strong>实现一条命令</strong>启动所有的<strong>应用服务</strong></p>
<blockquote>
<p>使用Compose的三个基础步骤</p>
</blockquote>
<ol>
<li><code>DockerFile</code>，保证项目在任何地方都可以运行</li>
<li>编写<code>docker-compose.yml</code>,</li>
<li> 启动项目<code>docker-compose up</code></li>
</ol>
<blockquote>
<p>作用：基本的容器编排</p>
</blockquote>
<p>Compose是Docker官方的开源项目。需要安装！</p>
<p><code>DockerFile</code>让程序在任何地方运行。web服务，redis，mysql，nginx等多个容器,这么多容器一个一个手动的去run非常的麻烦，通过Compose我们就可以直接一条命令解决！！！</p>
<p>Compose: docker-compose.yml</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.9&quot;</span>  <span class="comment"># optional since v1.27.0</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5000:5000&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">.:/code</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">logvolume01:/var/log</span></span><br><span class="line">    <span class="attr">links:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">logvolume01:</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>Compose：重要的概念</p>
<ul>
<li>服务services，容器。应用。（web、redis、mysql）</li>
<li>项目project。一组关联的容器。博客、web、mysql</li>
</ul>
<h5 id="docker-Compose安装"><a href="#docker-Compose安装" class="headerlink" title="docker Compose安装"></a>docker Compose安装</h5><ol>
<li>Run this command to download the current stable release of Docker Compose:</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L &quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>Apply executable permissions to the binary:</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>ln软连接</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>测试安装是否完成</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">docker-compose --version</span></span><br><span class="line">docker-compose version 1.29.2, build 1110ad01</span><br></pre></td></tr></table></figure>



<h5 id="测试案例"><a href="#测试案例" class="headerlink" title="测试案例"></a>测试案例</h5><p>python应用：计数器； redis！</p>
<p>compose一般使用的步骤：</p>
<ol>
<li>创建应用文件 app.py</li>
<li>DockerFile（应用打包成镜像）</li>
<li>Docker-compose.yaml文件（定义整个服务，需要的环境、web、redis） 完整的上线服务</li>
<li>启动compose项目（docker-compose up）</li>
</ol>
<blockquote>
<p> Step1:Setup</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># </span><span class="language-bash">1.Create a directory <span class="keyword">for</span> the project:</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash"><span class="built_in">mkdir</span> composetest</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash"><span class="built_in">cd</span> composetest</span></span><br><span class="line"><span class="meta"># </span><span class="language-bash">2.Create a file called app.py <span class="keyword">in</span> your project directory and <span class="built_in">paste</span> this <span class="keyword">in</span>:</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">vim app.py</span></span><br><span class="line"></span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">import redis</span><br><span class="line">from flask import Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">cache = redis.Redis(host=&#x27;redis&#x27;, port=6379)</span><br><span class="line"></span><br><span class="line">def get_hit_count():</span><br><span class="line">    retries = 5</span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            return cache.incr(&#x27;hits&#x27;)</span><br><span class="line">        except redis.exceptions.ConnectionError as exc:</span><br><span class="line">            if retries == 0:</span><br><span class="line">                raise exc</span><br><span class="line">            retries -= 1</span><br><span class="line">            time.sleep(0.5)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def hello():</span><br><span class="line">    count = get_hit_count()</span><br><span class="line">    return &#x27;Hello World! I have been seen &#123;&#125; times.\n&#x27;.format(count)</span><br><span class="line"><span class="meta"># </span><span class="language-bash">3.Create another file called requirements.txt <span class="keyword">in</span> your project directory and <span class="built_in">paste</span> this <span class="keyword">in</span>:</span></span><br><span class="line"><span class="meta">$ </span><span class="language-bash">vim requirements.txt</span></span><br><span class="line">flask</span><br><span class="line">redis</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Step2: Create a Dockerfile</p>
</blockquote>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># syntax=docker/dockerfile:1</span></span><br><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.7</span>-alpine</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i -e <span class="string">&#x27;s/http:/https:/&#x27;</span> /etc/apk/repositories</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /code</span></span><br><span class="line"><span class="keyword">ENV</span> FLASK_APP=app.py</span><br><span class="line"><span class="keyword">ENV</span> FLASK_RUN_HOST=<span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apk add --no-cache gcc musl-dev linux-headers</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> requirements.txt requirements.txt</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> pip install -r requirements.txt</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">5000</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> . .</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;flask&quot;</span>, <span class="string">&quot;run&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Step 3: Define services in a Compose file  docker-compose.yml</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.9&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5000:5000&quot;</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&quot;redis:alpine&quot;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Step 4: Build and run your app with Compose  </p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$ </span><span class="language-bash">docker-compose up</span></span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@hadoop102 hadoop]# curl localhost:5000</span><br><span class="line">Hello World! I have been seen 1 times.</span><br><span class="line">[root@hadoop102 hadoop]# curl localhost:5000</span><br><span class="line">Hello World! I have been seen 2 times.</span><br><span class="line"></span><br><span class="line">[root@hadoop102 hadoop]# docker ps</span><br><span class="line">CONTAINER ID   IMAGE             COMMAND                  CREATED         STATUS         PORTS                                       NAMES</span><br><span class="line">feace8f427c9   redis:alpine      &quot;docker-entrypoint.s…&quot;   5 minutes ago   Up 5 minutes   6379/tcp                                    composetest_redis_1</span><br><span class="line">68a9e5a7c4e4   composetest_web   &quot;flask run&quot;              5 minutes ago   Up 5 minutes   0.0.0.0:5000-&gt;5000/tcp, :::5000-&gt;5000/tcp   composetest_web_1</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="Yaml-规则"><a href="#Yaml-规则" class="headerlink" title="Yaml 规则"></a>Yaml 规则</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3 层</span></span><br><span class="line"><span class="attr">version:</span> <span class="string">&#x27;&#x27;</span>  <span class="comment"># 版本</span></span><br><span class="line"><span class="attr">services:</span> <span class="comment"># 服务</span></span><br><span class="line">	<span class="string">服务1</span> <span class="attr">web:</span></span><br><span class="line">		<span class="string">images</span></span><br><span class="line">		<span class="string">build</span></span><br><span class="line">		<span class="string">network</span></span><br><span class="line">	<span class="string">服务2</span> <span class="string">redis</span></span><br><span class="line">		<span class="string">....</span></span><br><span class="line">	<span class="string">服务3</span></span><br><span class="line"><span class="comment"># 其他配置</span></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line"><span class="attr">configs:</span></span><br><span class="line">		</span><br></pre></td></tr></table></figure>

<p>用的时候，可以查看官方文档<a target="_blank" rel="noopener" href="https://docs.docker.com/compose/compose-file/compose-file-v3/">https://docs.docker.com/compose/compose-file/compose-file-v3/</a></p>
<h5 id="使用Compose一键部署WP博客"><a href="#使用Compose一键部署WP博客" class="headerlink" title="使用Compose一键部署WP博客"></a>使用Compose一键部署WP博客</h5><p>（WP、HEXO）</p>
<ol>
<li>创建wordpress目录并进入</li>
<li>创建docker-compose.yml</li>
</ol>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.9&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db_data:/var/lib/mysql</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">somewordpress</span></span><br><span class="line">      <span class="attr">MYSQL_DATABASE:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">MYSQL_USER:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">MYSQL_PASSWORD:</span> <span class="string">wordpress</span></span><br><span class="line">    </span><br><span class="line">  <span class="attr">wordpress:</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">wordpress:latest</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">wordpress_data:/var/www/html</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8000:80&quot;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_HOST:</span> <span class="string">db:3306</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_USER:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_PASSWORD:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_NAME:</span> <span class="string">wordpress</span></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">db_data:</span> &#123;&#125;</span><br><span class="line">  <span class="attr">wordpress_data:</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>docker-compose up 启动</li>
</ol>
<h2 id="Docker-Swarm"><a href="#Docker-Swarm" class="headerlink" title="Docker Swarm"></a>Docker Swarm</h2><h2 id="CI-CD-Jenkins-流水线！"><a href="#CI-CD-Jenkins-流水线！" class="headerlink" title="CI/CD Jenkins 流水线！"></a>CI/CD Jenkins 流水线！</h2><p>企业实战</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/06/24/Kubernetes%E5%AD%A6%E4%B9%A0/" rel="prev" title="Kubernetes学习笔记">
      <i class="fa fa-chevron-left"></i> Kubernetes学习笔记
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/06/24/Git%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="next" title="Git学习随手记">
      Git学习随手记 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker-%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0"><span class="nav-number">1.</span> <span class="nav-text">Docker 入门学习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#docker%E5%92%8C%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%8A%80%E6%9C%AF%E7%9A%84%E4%B8%8D%E5%90%8C"><span class="nav-number">1.0.1.</span> <span class="nav-text">docker和虚拟机技术的不同</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E5%AE%89%E8%A3%85"><span class="nav-number">1.1.</span> <span class="nav-text">Docker安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90"><span class="nav-number">1.1.1.</span> <span class="nav-text">Docker 的基本组成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Docker"><span class="nav-number">1.1.2.</span> <span class="nav-text">安装Docker</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%B8%E8%BD%BD%E6%97%A7%E7%89%88"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">卸载旧版</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85yum-yum-utils%E5%9F%BA%E7%A1%80%E5%B7%A5%E5%85%B7"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">安装yum yum-utils基础工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0yum%E7%B4%A2%E5%BC%95"><span class="nav-number">1.1.2.3.</span> <span class="nav-text">更新yum索引</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85Docker%E5%BC%95%E6%93%8E"><span class="nav-number">1.1.2.4.</span> <span class="nav-text">安装Docker引擎</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8Docker%E6%9C%8D%E5%8A%A1"><span class="nav-number">1.1.2.5.</span> <span class="nav-text">启动Docker服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E5%BC%80%E6%9C%BA%E8%87%AA%E5%90%AF"><span class="nav-number">1.1.2.6.</span> <span class="nav-text">设置开机自启</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AEdocker%E9%95%9C%E5%83%8F%E6%BA%90"><span class="nav-number">1.1.2.7.</span> <span class="nav-text">设置docker镜像源</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.3.</span> <span class="nav-text">Docker底层原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Docker%E6%98%AF%E6%80%8E%E4%B9%88%E5%B7%A5%E4%BD%9C%E7%9A%84%EF%BC%9F"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">Docker是怎么工作的？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Docker%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AF%94VM%E5%BF%AB%EF%BC%9F"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">Docker为什么比VM快？</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E7%9A%84%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.</span> <span class="nav-text">Docker的常用命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%AE%E5%8A%A9%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.1.</span> <span class="nav-text">帮助命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.2.</span> <span class="nav-text">镜像命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-images-%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E6%9C%AC%E5%9C%B0%E7%9A%84%E4%B8%BB%E6%9C%BA%E4%B8%8A%E7%9A%84%E9%95%9C%E5%83%8F"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">docker images 查看所有本地的主机上的镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-search%E6%90%9C%E7%B4%A2%E9%95%9C%E5%83%8F"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">docker search搜索镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-pull-tag-%E4%B8%8B%E8%BD%BD%E9%95%9C%E5%83%8F"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">docker pull[:tag] 下载镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#docker-rmi-imageID-%E5%88%A0%E9%99%A4%E9%95%9C%E5%83%8F%E3%80%81"><span class="nav-number">1.2.2.4.</span> <span class="nav-text">docker rmi imageID:删除镜像、</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.3.</span> <span class="nav-text">容器命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA%E5%AE%B9%E5%99%A8%E5%B9%B6%E5%90%AF%E5%8A%A8%EF%BC%9Adocker-run"><span class="nav-number">1.2.3.1.</span> <span class="nav-text">新建容器并启动：docker run</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%80%E5%87%BA%E5%AE%B9%E5%99%A8%EF%BC%9Aexit"><span class="nav-number">1.2.3.2.</span> <span class="nav-text">退出容器：exit</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8%EF%BC%9Adocker-ps"><span class="nav-number">1.2.3.3.</span> <span class="nav-text">查看运行的容器：docker ps</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%AE%B9%E5%99%A8"><span class="nav-number">1.2.3.4.</span> <span class="nav-text">删除容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E5%92%8C%E5%81%9C%E6%AD%A2%E5%AE%B9%E5%99%A8%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-number">1.2.3.5.</span> <span class="nav-text">启动和停止容器的操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.4.</span> <span class="nav-text">常用其他命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E5%90%AF%E5%8A%A8-%E5%AE%B9%E5%99%A8"><span class="nav-number">1.2.4.1.</span> <span class="nav-text">后台启动+容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%98%BE%E7%A4%BA%E6%97%A5%E5%BF%97"><span class="nav-number">1.2.4.2.</span> <span class="nav-text">显示日志</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%AE%B9%E5%99%A8%E4%B8%AD%E7%9A%84%E8%BF%9B%E7%A8%8B%E4%BF%A1%E6%81%AF%EF%BC%88top%EF%BC%89"><span class="nav-number">1.2.4.3.</span> <span class="nav-text">查看容器中的进程信息（top）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E7%9A%84%E5%85%83%E6%95%B0%E6%8D%AE-inspect"><span class="nav-number">1.2.4.4.</span> <span class="nav-text">查看镜像的元数据(inspect)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E5%85%A5%E5%BD%93%E5%89%8D%E6%AD%A3%E5%9C%A8%E8%BF%90%E8%A1%8C%E7%9A%84%E5%AE%B9%E5%99%A8"><span class="nav-number">1.2.4.5.</span> <span class="nav-text">进入当前正在运行的容器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8E%E5%AE%B9%E5%99%A8%E5%86%85%E6%8B%B7%E8%B4%9D%E6%96%87%E4%BB%B6%E5%88%B0%E4%B8%BB%E6%9C%BA%E4%B8%8A%EF%BC%88%E5%8F%8D%E5%90%91%E6%8B%B7%E8%B4%9D%E4%B9%9F%E6%98%AF%E5%8F%AF%E4%BB%A5%E7%9A%84%EF%BC%89"><span class="nav-number">1.2.4.6.</span> <span class="nav-text">从容器内拷贝文件到主机上（反向拷贝也是可以的）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4%E5%B0%8F%E7%BB%93"><span class="nav-number">1.2.5.</span> <span class="nav-text">常用命令小结</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E7%AE%A1%E7%90%86"><span class="nav-number">1.2.5.1.</span> <span class="nav-text">容器生命周期管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">1.2.5.2.</span> <span class="nav-text">容器操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8rootfs%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.5.3.</span> <span class="nav-text">容器rootfs命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93"><span class="nav-number">1.2.5.4.</span> <span class="nav-text">镜像仓库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E9%95%9C%E5%83%8F%E7%AE%A1%E7%90%86"><span class="nav-number">1.2.5.5.</span> <span class="nav-text">本地镜像管理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#info-version"><span class="nav-number">1.2.5.6.</span> <span class="nav-text">info|version</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E9%95%9C%E5%83%8F%E8%AE%B2%E8%A7%A3"><span class="nav-number">1.3.</span> <span class="nav-text">Docker镜像讲解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">1.3.1.</span> <span class="nav-text">镜像是什么？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E8%BD%BD%E5%8E%9F%E7%90%86"><span class="nav-number">1.3.2.</span> <span class="nav-text">Docker镜像加载原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%9C%E5%83%8F%E7%9A%84%E5%88%86%E5%B1%82"><span class="nav-number">1.3.3.</span> <span class="nav-text">镜像的分层</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Commit%E9%95%9C%E5%83%8F"><span class="nav-number">1.3.4.</span> <span class="nav-text">Commit镜像</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0"><span class="nav-number">2.</span> <span class="nav-text">Docker进阶学习</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">2.1.</span> <span class="nav-text">容器数据卷</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E5%AE%B9%E5%99%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"><span class="nav-number">2.1.1.</span> <span class="nav-text">什么是容器数据卷</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%8D%B7%EF%BC%88-v%EF%BC%89"><span class="nav-number">2.1.2.</span> <span class="nav-text">使用数据卷（-v）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B7%E5%90%8D%E6%8C%82%E8%BD%BD-%E4%B8%8E-%E5%8C%BF%E5%90%8D%E6%8C%82%E8%BD%BD"><span class="nav-number">2.1.3.</span> <span class="nav-text">具名挂载 与 匿名挂载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8%EF%BC%88%E5%AE%B9%E5%99%A8%E4%B8%8E%E5%AE%B9%E5%99%A8%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE%E5%8D%B7%EF%BC%89"><span class="nav-number">2.1.4.</span> <span class="nav-text">数据卷容器（容器与容器之间共享数据卷）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DockerFile"><span class="nav-number">2.2.</span> <span class="nav-text">DockerFile</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DockerFile%E4%BB%8B%E7%BB%8D"><span class="nav-number">2.2.1.</span> <span class="nav-text">DockerFile介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DockerFile%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="nav-number">2.2.2.</span> <span class="nav-text">DockerFile构建过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DockerFile%E6%8C%87%E4%BB%A4"><span class="nav-number">2.2.3.</span> <span class="nav-text">DockerFile指令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%84%E5%BB%BADockerFile%E4%B9%8B%E5%89%8D%E7%9A%84%E8%AF%B4%E6%98%8E"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">构建DockerFile之前的说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Docker%E6%9E%84%E5%BB%BADockerFile%E5%91%BD%E4%BB%A4"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">Docker构建DockerFile命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DockerFile-Centos%E5%AE%98%E6%96%B9%E6%A0%B7%E4%BE%8B"><span class="nav-number">2.2.3.3.</span> <span class="nav-text">DockerFile Centos官方样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DockerFile%E4%B8%AD%E7%9A%84%E5%85%B3%E9%94%AE%E5%AD%97%E8%AF%B4%E6%98%8E"><span class="nav-number">2.2.3.4.</span> <span class="nav-text">DockerFile中的关键字说明</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#FROM"><span class="nav-number">2.2.3.4.1.</span> <span class="nav-text">FROM</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#ARG%E5%92%8CFROM"><span class="nav-number">2.2.3.4.1.1.</span> <span class="nav-text">ARG和FROM</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#RUN"><span class="nav-number">2.2.3.4.2.</span> <span class="nav-text">RUN</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#CMD-%E4%B8%8E-ENTRYPOINT"><span class="nav-number">2.2.3.4.3.</span> <span class="nav-text">CMD 与 ENTRYPOINT</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#EXPOSE"><span class="nav-number">2.2.3.4.4.</span> <span class="nav-text">EXPOSE</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ENV"><span class="nav-number">2.2.3.4.5.</span> <span class="nav-text">ENV</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ADD%E5%92%8CCOPY"><span class="nav-number">2.2.3.4.6.</span> <span class="nav-text">ADD和COPY</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#VOLUME"><span class="nav-number">2.2.3.4.7.</span> <span class="nav-text">VOLUME</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker%E7%BD%91%E7%BB%9C"><span class="nav-number">2.3.</span> <span class="nav-text">Docker网络</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%90%86%E8%A7%A3Docker0"><span class="nav-number">2.3.1.</span> <span class="nav-text">理解Docker0</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#bridge%E6%A8%A1%E5%BC%8F"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">bridge模式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%B9%E5%99%A8%E4%BA%92%E8%81%94"><span class="nav-number">2.3.2.</span> <span class="nav-text">容器互联</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%80%93link%EF%BC%88%E4%B8%8D%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8%EF%BC%89"><span class="nav-number">2.3.2.1.</span> <span class="nav-text">–link（不推荐使用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BD%91%E7%BB%9C"><span class="nav-number">2.3.2.2.</span> <span class="nav-text">自定义网络</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E8%BF%9E%E9%80%9A"><span class="nav-number">2.3.2.3.</span> <span class="nav-text">网络连通</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-Compose"><span class="nav-number">2.4.</span> <span class="nav-text">Docker Compose</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#docker-Compose%E5%AE%89%E8%A3%85"><span class="nav-number">2.4.0.0.1.</span> <span class="nav-text">docker Compose安装</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%E6%A1%88%E4%BE%8B"><span class="nav-number">2.4.0.0.2.</span> <span class="nav-text">测试案例</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Yaml-%E8%A7%84%E5%88%99"><span class="nav-number">2.4.0.0.3.</span> <span class="nav-text">Yaml 规则</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8Compose%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2WP%E5%8D%9A%E5%AE%A2"><span class="nav-number">2.4.0.0.4.</span> <span class="nav-text">使用Compose一键部署WP博客</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-Swarm"><span class="nav-number">2.5.</span> <span class="nav-text">Docker Swarm</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CI-CD-Jenkins-%E6%B5%81%E6%B0%B4%E7%BA%BF%EF%BC%81"><span class="nav-number">2.6.</span> <span class="nav-text">CI&#x2F;CD Jenkins 流水线！</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
